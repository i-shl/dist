import{a2 as r}from"./index-NezMn2gx.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"051ca6428b97c6d36ca483b6bd6aaeed95b441f8"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new e.Error().stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="5a4adab0-e19d-435e-8740-66dd7fd82c92",e._sentryDebugIdIdentifier="sentry-dbid-5a4adab0-e19d-435e-8740-66dd7fd82c92")})()}catch{}function s(){if(typeof window<"u"&&window.uni)return window.uni;if(typeof globalThis<"u"&&globalThis.uni)return globalThis.uni}function t(){const e=r();return["mp-weixin","mp-qiwei","mp-lark"].includes(e.env)}function a(){return new Promise(e=>{if(!t()){e();return}const o=s();if(o&&typeof o.postMessage=="function"){e();return}const n=()=>{const i=s();i&&typeof i.postMessage=="function"&&e()};n(),document.addEventListener("UniAppJSBridgeReady",n,{once:!0}),setTimeout(()=>{document.removeEventListener("UniAppJSBridgeReady",n),e()},5e3)})}async function d(e){try{if(t()){await a();const n=s();if(n&&typeof n.postMessage=="function")try{return n.postMessage({data:e}),console.log("消息已通过 uni.postMessage 发送到小程序:",e),!0}catch(i){console.warn("uni.postMessage 发送失败，尝试使用 window.postMessage:",i)}}if(typeof window<"u"&&typeof window.postMessage=="function")try{const n={type:"webview-message",data:e};return window.parent.postMessage(n,"*"),console.log("消息已通过 window.postMessage 发送:",e),!0}catch(n){return console.error("window.postMessage 发送失败:",n),!1}return console.warn("无法发送消息：window.postMessage 不可用"),!1}catch(o){return console.error("发送消息失败:",o),!1}}async function u(e){return await d({action:"test",page:e,timestamp:Date.now(),message:`来自 ${e} 页面的测试消息`})}export{d as a,u as s};
