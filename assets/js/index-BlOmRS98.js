import{c as j,e as ee,ax as ct,at as ue,d as G,aE as ae,aj as ce,n as ne,r as F,af as rt,i as S,h as Ce,D as fe,aF as st,ab as je,a as f,ah as Ge,ak as de,o as J,u as Oe,aG as ut,F as dt,aH as ft,H as p,t as N,m as le,aI as mt,a4 as vt,ac as He,l as Me,M as ie,aJ as ht,am as ge,w as me,N as gt,ao as bt,aK as Ze,an as yt,aL as Dt,K as wt,ad as we,aM as kt,I as Ae,al as ke,aN as Tt,P as St,aO as be,ag as xt,Z as $e}from"./index-Dl01RQ6O.js";import{s as Ct,c as Ot}from"./index-BqICLX6q.js";import{T as Mt,a as Pt,u as Rt}from"./index-Agfgz_aq.js";import{B as It}from"./index-DOrlSKCD.js";import{u as Bt}from"./use-height-fYRUoBwt.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"dadf989baaa19ca9a7dda97cefda507d3b8f8f5a"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ae323e53-8998-4445-9616-47db81186aba",e._sentryDebugIdIdentifier="sentry-dbid-ae323e53-8998-4445-9616-47db81186aba")})()}catch{}const[_t,q,Ve]=j("picker"),qe=e=>e.find(n=>!n.disabled)||e[0];function Et(e,n){const t=e[0];if(t){if(Array.isArray(t))return"multiple";if(n.children in t)return"cascade"}return"default"}function se(e,n){n=ue(n,0,e.length);for(let t=n;t<e.length;t++)if(!e[t].disabled)return t;for(let t=n-1;t>=0;t--)if(!e[t].disabled)return t;return 0}const Ne=(e,n,t)=>n!==void 0&&e.some(l=>l[t.value]===n);function Te(e,n,t){const l=e.findIndex(m=>m[t.value]===n),r=se(e,l);return e[r]}function Ht(e,n,t){const l=[];let r={[n.children]:e},m=0;for(;r&&r[n.children];){const y=r[n.children],x=t.value[m];if(r=ct(x)?Te(y,x,n):void 0,!r&&y.length){const D=qe(y)[n.value];r=Te(y,D,n)}m++,l.push(y)}return l}function At(e){const{transform:n}=window.getComputedStyle(e),t=n.slice(7,n.length-1).split(", ")[5];return Number(t)}function $t(e){return ee({text:"text",value:"value",children:"children"},e)}const Fe=200,Ye=300,Vt=15,[Je,ye]=j("picker-column"),Qe=Symbol(Je);var Nt=G({name:Je,props:{value:ne,fields:ae(Object),options:ce(),readonly:Boolean,allowHtml:Boolean,optionHeight:ae(Number),swipeDuration:ae(ne),visibleOptionNum:ae(ne)},emits:["change","clickOption","scrollInto"],setup(e,{emit:n,slots:t}){let l,r,m,y,x;const D=F(),h=F(),b=F(0),s=F(0),C=rt(),d=()=>e.options.length,w=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,I=c=>{let v=se(e.options,c);const a=-v*e.optionHeight,i=()=>{v>d()-1&&(v=se(e.options,c));const g=e.options[v][e.fields.value];g!==e.value&&n("change",g)};l&&a!==b.value?x=i:i(),b.value=a},M=()=>e.readonly||!e.options.length,B=c=>{l||M()||(x=null,s.value=Fe,I(c),n("clickOption",e.options[c]))},_=c=>ue(Math.round(-c/e.optionHeight),0,d()-1),z=S(()=>_(b.value)),Y=(c,v)=>{const a=Math.abs(c/v);c=b.value+a/.003*(c<0?-1:1);const i=_(c);s.value=+e.swipeDuration,I(i)},V=()=>{l=!1,s.value=0,x&&(x(),x=null)},L=c=>{if(!M()){if(C.start(c),l){const v=At(h.value);b.value=Math.min(0,v-w())}s.value=0,r=b.value,m=Date.now(),y=r,x=null}},W=c=>{if(M())return;C.move(c),C.isVertical()&&(l=!0,Ge(c,!0));const v=ue(r+C.deltaY.value,-(d()*e.optionHeight),e.optionHeight),a=_(v);a!==z.value&&n("scrollInto",e.options[a]),b.value=v;const i=Date.now();i-m>Ye&&(m=i,y=v)},H=()=>{if(M())return;const c=b.value-y,v=Date.now()-m;if(v<Ye&&Math.abs(c)>Vt){Y(c,v);return}const i=_(b.value);s.value=Fe,I(i),setTimeout(()=>{l=!1},0)},X=()=>{const c={height:`${e.optionHeight}px`};return e.options.map((v,a)=>{const i=v[e.fields.text],{disabled:g}=v,A=v[e.fields.value],K={role:"button",style:c,tabindex:g?-1:0,class:[ye("item",{disabled:g,selected:A===e.value}),v.className],onClick:()=>B(a)},he={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:i};return f("li",K,[t.option?t.option(v,a):f("div",he,null)])})};return Ce(Qe),fe({stopMomentum:V}),st(()=>{const c=l?Math.floor(-b.value/e.optionHeight):e.options.findIndex(i=>i[e.fields.value]===e.value),v=se(e.options,c),a=-v*e.optionHeight;l&&v<c&&V(),b.value=a}),je("touchmove",W,{target:D}),()=>f("div",{ref:D,class:ye(),onTouchstartPassive:L,onTouchend:H,onTouchcancel:H},[f("ul",{ref:h,style:{transform:`translate3d(0, ${b.value+w()}px, 0)`,transitionDuration:`${s.value}ms`,transitionProperty:s.value?"all":"none"},class:ye("wrapper"),onTransitionend:V},[X()])])}});const[Ft]=j("picker-toolbar"),ve={title:String,cancelButtonText:String,confirmButtonText:String},Xe=["cancel","confirm","title","toolbar"],Yt=Object.keys(ve);var pe=G({name:Ft,props:ve,emits:["confirm","cancel"],setup(e,{emit:n,slots:t}){const l=()=>{if(t.title)return t.title();if(e.title)return f("div",{class:[q("title"),"van-ellipsis"]},[e.title])},r=()=>n("cancel"),m=()=>n("confirm"),y=()=>{var D;const h=(D=e.cancelButtonText)!=null?D:Ve("cancel");if(!(!t.cancel&&!h))return f("button",{type:"button",class:[q("cancel"),de],onClick:r},[t.cancel?t.cancel():h])},x=()=>{var D;const h=(D=e.confirmButtonText)!=null?D:Ve("confirm");if(!(!t.confirm&&!h))return f("button",{type:"button",class:[q("confirm"),de],onClick:m},[t.confirm?t.confirm():h])};return()=>f("div",{class:q("toolbar")},[t.toolbar?t.toolbar():[y(),l(),x()]])}});const Wt=(e,n)=>{const t=F(e());return J(e,l=>{l!==t.value&&(t.value=l)}),J(t,l=>{l!==e()&&n(l)}),t},[et,De]=j("picker-group"),tt=Symbol(et),Kt=ee({tabs:ce(),activeTab:le(0),nextStepText:String,showToolbar:N},ve);var Dn=G({name:et,props:Kt,emits:["confirm","cancel","update:activeTab"],setup(e,{emit:n,slots:t}){const l=Wt(()=>e.activeTab,h=>n("update:activeTab",h)),{children:r,linkChildren:m}=Oe(tt);m();const y=()=>+l.value<e.tabs.length-1&&e.nextStepText,x=()=>{y()?l.value=+l.value+1:n("confirm",r.map(h=>h.confirm()))},D=()=>n("cancel");return()=>{var h,b;let s=(b=(h=t.default)==null?void 0:h.call(t))==null?void 0:b.filter(d=>d.type!==ut).map(d=>d.type===dt?d.children:d);s&&(s=ft(s));const C=y()?e.nextStepText:e.confirmButtonText;return f("div",{class:De()},[e.showToolbar?f(pe,{title:e.title,cancelButtonText:e.cancelButtonText,confirmButtonText:C,onConfirm:x,onCancel:D},p(t,Xe)):null,f(Mt,{active:l.value,"onUpdate:active":d=>l.value=d,class:De("tabs"),shrink:!0,animated:!0,lazyRender:!1},{default:()=>[e.tabs.map((d,w)=>f(Pt,{title:d,titleClass:De("tab-title")},{default:()=>[s?.[w]]}))]})])}}});const Pe=ee({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:le(44),showToolbar:N,swipeDuration:le(1e3),visibleOptionNum:le(6)},ve),Ut=ee({},Pe,{columns:ce(),modelValue:ce(),toolbarPosition:ie("top"),columnsFieldNames:Object});var zt=G({name:_t,props:Ut,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:n,slots:t}){const l=F(),r=F(e.modelValue.slice(0)),{parent:m}=Ce(tt),{children:y,linkChildren:x}=Oe(Qe);x();const D=S(()=>$t(e.columnsFieldNames)),h=S(()=>mt(e.optionHeight)),b=S(()=>Et(e.columns,D.value)),s=S(()=>{const{columns:a}=e;switch(b.value){case"multiple":return a;case"cascade":return Ht(a,D.value,r);default:return[a]}}),C=S(()=>s.value.some(a=>a.length)),d=S(()=>s.value.map((a,i)=>Te(a,r.value[i],D.value))),w=S(()=>s.value.map((a,i)=>a.findIndex(g=>g[D.value.value]===r.value[i]))),I=(a,i)=>{if(r.value[a]!==i){const g=r.value.slice(0);g[a]=i,r.value=g}},M=()=>({selectedValues:r.value.slice(0),selectedOptions:d.value,selectedIndexes:w.value}),B=(a,i)=>{I(i,a),b.value==="cascade"&&r.value.forEach((g,A)=>{const K=s.value[A];Ne(K,g,D.value)||I(A,K.length?K[0][D.value.value]:void 0)}),He(()=>{n("change",ee({columnIndex:i},M()))})},_=(a,i)=>{const g={columnIndex:i,currentOption:a};n("clickOption",ee(M(),g)),n("scrollInto",g)},z=()=>{y.forEach(i=>i.stopMomentum());const a=M();return He(()=>{const i=M();n("confirm",i)}),a},Y=()=>n("cancel",M()),V=()=>s.value.map((a,i)=>f(Nt,{value:r.value[i],fields:D.value,options:a,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:h.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:g=>B(g,i),onClickOption:g=>_(g,i),onScrollInto:g=>{n("scrollInto",{currentOption:g,columnIndex:i})}},{option:t.option})),L=a=>{if(C.value){const i={height:`${h.value}px`},g={backgroundSize:`100% ${(a-h.value)/2}px`};return[f("div",{class:q("mask"),style:g},null),f("div",{class:[ht,q("frame")],style:i},null)]}},W=()=>{const a=h.value*+e.visibleOptionNum,i={height:`${a}px`};return!e.loading&&!C.value&&t.empty?t.empty():f("div",{ref:l,class:q("columns"),style:i},[V(),L(a)])},H=()=>{if(e.showToolbar&&!m)return f(pe,Me(p(e,Yt),{onConfirm:z,onCancel:Y}),p(t,Xe))},X=a=>{a.forEach((i,g)=>{i.length&&!Ne(i,r.value[g],D.value)&&I(g,qe(i)[D.value.value])})};J(s,a=>X(a),{immediate:!0});let c;return J(()=>e.modelValue,a=>{!ge(a,r.value)&&!ge(a,c)&&(r.value=a.slice(0),c=a.slice(0)),e.modelValue.length===0&&X(s.value)},{deep:!0}),J(r,a=>{ge(a,e.modelValue)||(c=a.slice(0),n("update:modelValue",c))},{immediate:!0}),je("touchmove",Ge,{target:l}),fe({confirm:z,getSelectedOptions:()=>d.value}),()=>{var a,i;return f("div",{class:q()},[e.toolbarPosition==="top"?H():null,e.loading?f(vt,{class:q("loading")},null):null,(a=t["columns-top"])==null?void 0:a.call(t),W(),(i=t["columns-bottom"])==null?void 0:i.call(t),e.toolbarPosition==="bottom"?H():null])}}});const wn=me(zt),[nt,Lt]=j("radio-group"),jt={shape:String,disabled:Boolean,iconSize:ne,direction:String,modelValue:gt,checkedColor:String},at=Symbol(nt);var Gt=G({name:nt,props:jt,emits:["change","update:modelValue"],setup(e,{emit:n,slots:t}){const{linkChildren:l}=Oe(at),r=m=>n("update:modelValue",m);return J(()=>e.modelValue,m=>n("change",m)),l({props:e,updateValue:r}),bt(()=>e.modelValue),()=>{var m;return f("div",{class:Lt([e.direction]),role:"radiogroup"},[(m=t.default)==null?void 0:m.call(t)])}}});const kn=me(Gt),Zt=ee({},Ot,{shape:String}),[qt,Jt]=j("radio");var Qt=G({name:qt,props:Zt,emits:["update:modelValue"],setup(e,{emit:n,slots:t}){const{parent:l}=Ce(at),r=()=>(l?l.props.modelValue:e.modelValue)===e.name,m=()=>{l?l.updateValue(e.name):n("update:modelValue",e.name)};return()=>f(Ct,Me({bem:Jt,role:"radio",parent:l,checked:r(),onToggle:m},e),p(t,["default","icon"]))}});const Tn=me(Qt),[Xt,O,Q]=j("calendar"),pt=e=>Q("monthTitle",e.getFullYear(),e.getMonth()+1);function te(e,n){const t=e.getFullYear(),l=n.getFullYear();if(t===l){const r=e.getMonth(),m=n.getMonth();return r===m?0:r>m?1:-1}return t>l?1:-1}function $(e,n){const t=te(e,n);if(t===0){const l=e.getDate(),r=n.getDate();return l===r?0:l>r?1:-1}return t}const oe=e=>new Date(e),We=e=>Array.isArray(e)?e.map(oe):oe(e);function Re(e,n){const t=oe(e);return t.setDate(t.getDate()+n),t}function Ie(e,n){const t=oe(e);return t.setMonth(t.getMonth()+n),t.getDate()!==e.getDate()&&t.setDate(0),t}function ot(e,n){const t=oe(e);return t.setFullYear(t.getFullYear()+n),t.getDate()!==e.getDate()&&t.setDate(0),t}const Se=e=>Re(e,-1),xe=e=>Re(e,1),Ke=e=>Ie(e,-1),Ue=e=>Ie(e,1),ze=e=>ot(e,-1),Le=e=>ot(e,1),re=()=>{const e=new Date;return e.setHours(0,0,0,0),e};function en(e){const n=e[0].getTime();return(e[1].getTime()-n)/(1e3*60*60*24)+1}function tn(e,n=0){const t=new Date(e.getFullYear(),e.getMonth()+1,0),l=n+e.getDate()-1,r=n+t.getDate()-1;return Math.floor(l/7)===Math.floor(r/7)}const Sn=ee({},Pe,{modelValue:ce(),filter:Function,formatter:{type:Function,default:(e,n)=>n}}),xn=Object.keys(Pe);function nn(e,n){if(e<0)return[];const t=Array(e);let l=-1;for(;++l<e;)t[l]=n(l);return t}const an=(e,n)=>32-new Date(e,n-1,32).getDate(),Cn=(e,n,t,l,r,m)=>{const y=nn(n-e+1,x=>{const D=Ze(e+x);return l(t,{text:D,value:D})});return r?r(t,y,m):y},On=(e,n)=>e.map((t,l)=>{const r=n[l];if(r.length){const m=+r[0].value,y=+r[r.length-1].value;return Ze(ue(+t,m,y))}return t}),[on]=j("calendar-day");var ln=G({name:on,props:{item:ae(Object),color:String,index:Number,offset:yt(0),rowHeight:String},emits:["click","clickDisabledDate"],setup(e,{emit:n,slots:t}){const l=S(()=>{const{item:h,index:b,color:s,offset:C,rowHeight:d}=e,w={height:d};if(h.type==="placeholder")return w.width="100%",w;if(b===0&&(w.marginLeft=`${100*C/7}%`),s)switch(h.type){case"end":case"start":case"start-end":case"multiple-middle":case"multiple-selected":w.background=s;break;case"middle":w.color=s;break}return h.date&&tn(h.date,C)&&(w.marginBottom=0),w}),r=()=>{e.item.type!=="disabled"?n("click",e.item):n("clickDisabledDate",e.item)},m=()=>{const{topInfo:h}=e.item;if(h||t["top-info"])return f("div",{class:O("top-info")},[t["top-info"]?t["top-info"](e.item):h])},y=()=>{const{bottomInfo:h}=e.item;if(h||t["bottom-info"])return f("div",{class:O("bottom-info")},[t["bottom-info"]?t["bottom-info"](e.item):h])},x=()=>t.text?t.text(e.item):e.item.text,D=()=>{const{item:h,color:b,rowHeight:s}=e,{type:C}=h,d=[m(),x(),y()];return C==="selected"?f("div",{class:O("selected-day"),style:{width:s,height:s,background:b}},[d]):d};return()=>{const{type:h,className:b}=e.item;return h==="placeholder"?f("div",{class:O("day"),style:l.value},null):f("div",{role:"gridcell",style:l.value,class:[O("day",h),b],tabindex:h==="disabled"?void 0:-1,onClick:r},[D()])}}});const[cn]=j("calendar-month"),rn={date:ae(Date),type:String,color:String,minDate:Date,maxDate:Date,showMark:Boolean,rowHeight:ne,formatter:Function,lazyRender:Boolean,currentDate:[Date,Array],allowSameDay:Boolean,showSubtitle:Boolean,showMonthTitle:Boolean,firstDayOfWeek:Number};var sn=G({name:cn,props:rn,emits:["click","clickDisabledDate"],setup(e,{emit:n,slots:t}){const[l,r]=Dt(),m=F(),y=F(),x=Bt(y),D=S(()=>pt(e.date)),h=S(()=>wt(e.rowHeight)),b=S(()=>{const c=e.date.getDate(),a=(e.date.getDay()-c%7+8)%7;return e.firstDayOfWeek?(a+7-e.firstDayOfWeek)%7:a}),s=S(()=>an(e.date.getFullYear(),e.date.getMonth()+1)),C=S(()=>l.value||!e.lazyRender),d=()=>D.value,w=c=>{const v=a=>e.currentDate.some(i=>$(i,a)===0);if(v(c)){const a=Se(c),i=xe(c),g=v(a),A=v(i);return g&&A?"multiple-middle":g?"end":A?"start":"multiple-selected"}return""},I=c=>{const[v,a]=e.currentDate;if(!v)return"";const i=$(c,v);if(!a)return i===0?"start":"";const g=$(c,a);return e.allowSameDay&&i===0&&g===0?"start-end":i===0?"start":g===0?"end":i>0&&g<0?"middle":""},M=c=>{const{type:v,minDate:a,maxDate:i,currentDate:g}=e;if(a&&$(c,a)<0||i&&$(c,i)>0)return"disabled";if(g===null)return"";if(Array.isArray(g)){if(v==="multiple")return w(c);if(v==="range")return I(c)}else if(v==="single")return $(c,g)===0?"selected":"";return""},B=c=>{if(e.type==="range"){if(c==="start"||c==="end")return Q(c);if(c==="start-end")return`${Q("start")}/${Q("end")}`}},_=()=>{if(e.showMonthTitle)return f("div",{class:O("month-title")},[t["month-title"]?t["month-title"]({date:e.date,text:D.value}):D.value])},z=()=>{if(e.showMark&&C.value)return f("div",{class:O("month-mark")},[e.date.getMonth()+1])},Y=S(()=>{const c=Math.ceil((s.value+b.value)/7);return Array(c).fill({type:"placeholder"})}),V=S(()=>{const c=[],v=e.date.getFullYear(),a=e.date.getMonth();for(let i=1;i<=s.value;i++){const g=new Date(v,a,i),A=M(g);let K={date:g,type:A,text:i,bottomInfo:B(A)};e.formatter&&(K=e.formatter(K)),c.push(K)}return c}),L=S(()=>V.value.filter(c=>c.type==="disabled")),W=(c,v)=>{if(m.value){const a=we(m.value),i=Y.value.length,A=(Math.ceil((v.getDate()+b.value)/7)-1)*a.height/i;kt(c,a.top+A+c.scrollTop-we(c).top)}},H=(c,v)=>f(ln,{item:c,index:v,color:e.color,offset:b.value,rowHeight:h.value,onClick:a=>n("click",a),onClickDisabledDate:a=>n("clickDisabledDate",a)},p(t,["top-info","bottom-info","text"])),X=()=>f("div",{ref:m,role:"grid",class:O("days")},[z(),(C.value?V:Y).value.map(H)]);return fe({getTitle:d,getHeight:()=>x.value,setVisible:r,scrollToDate:W,disabledDays:L}),()=>f("div",{class:O("month"),ref:y},[_(),X()])}});const[un]=j("calendar-header");var dn=G({name:un,props:{date:Date,minDate:Date,maxDate:Date,title:String,subtitle:String,showTitle:Boolean,showSubtitle:Boolean,firstDayOfWeek:Number,switchMode:ie("none")},emits:["clickSubtitle","panelChange"],setup(e,{slots:n,emit:t}){const l=S(()=>e.date&&e.minDate&&te(Ke(e.date),e.minDate)<0),r=S(()=>e.date&&e.minDate&&te(ze(e.date),e.minDate)<0),m=S(()=>e.date&&e.maxDate&&te(Ue(e.date),e.maxDate)>0),y=S(()=>e.date&&e.maxDate&&te(Le(e.date),e.maxDate)>0),x=()=>{if(e.showTitle){const d=e.title||Q("title"),w=n.title?n.title():d;return f("div",{class:O("header-title")},[w])}},D=d=>t("clickSubtitle",d),h=d=>t("panelChange",d),b=d=>{const w=e.switchMode==="year-month",I=n[d?"next-month":"prev-month"],M=n[d?"next-year":"prev-year"],B=d?m.value:l.value,_=d?y.value:r.value,z=d?"arrow":"arrow-left",Y=d?"arrow-double-right":"arrow-double-left",V=()=>h((d?Ue:Ke)(e.date)),L=()=>h((d?Le:ze)(e.date)),W=f("view",{class:O("header-action",{disabled:B}),onClick:B?void 0:V},[I?I({disabled:B}):f(Ae,{class:{[de]:!B},name:z},null)]),H=w&&f("view",{class:O("header-action",{disabled:_}),onClick:_?void 0:L},[M?M({disabled:_}):f(Ae,{class:{[de]:!_},name:Y},null)]);return d?[W,H]:[H,W]},s=()=>{if(e.showSubtitle){const d=n.subtitle?n.subtitle({date:e.date,text:e.subtitle}):e.subtitle,w=e.switchMode!=="none";return f("div",{class:O("header-subtitle",{"with-switch":w}),onClick:D},[w?[b(),f("div",{class:O("header-subtitle-text")},[d]),b(!0)]:d])}},C=()=>{const{firstDayOfWeek:d}=e,w=Q("weekdays"),I=[...w.slice(d,7),...w.slice(0,d)];return f("div",{class:O("weekdays")},[I.map(M=>f("span",{class:O("weekday")},[M]))])};return()=>f("div",{class:O("header")},[x(),s(),C()])}});const fn={show:Boolean,type:ie("single"),switchMode:ie("none"),title:String,color:String,round:N,readonly:Boolean,poppable:N,maxRange:le(null),position:ie("bottom"),teleport:[String,Object],showMark:N,showTitle:N,formatter:Function,rowHeight:ne,confirmText:String,rangePrompt:String,lazyRender:N,showConfirm:N,defaultDate:[Date,Array],allowSameDay:Boolean,showSubtitle:N,closeOnPopstate:N,showRangePrompt:N,confirmDisabledText:String,closeOnClickOverlay:N,safeAreaInsetTop:Boolean,safeAreaInsetBottom:N,minDate:{type:Date,validator:ke},maxDate:{type:Date,validator:ke},firstDayOfWeek:{type:ne,default:0,validator:e=>e>=0&&e<=6}};var mn=G({name:Xt,props:fn,emits:["select","confirm","unselect","monthShow","overRange","update:show","clickSubtitle","clickDisabledDate","clickOverlay","panelChange"],setup(e,{emit:n,slots:t}){const l=S(()=>e.switchMode!=="none"),r=S(()=>!e.minDate&&!l.value?re():e.minDate),m=S(()=>!e.maxDate&&!l.value?Ie(re(),6):e.maxDate),y=(o,u=r.value,T=m.value)=>u&&$(o,u)===-1?u:T&&$(o,T)===1?T:o,x=(o=e.defaultDate)=>{const{type:u,allowSameDay:T}=e;if(o===null)return o;const k=re();if(u==="range"){Array.isArray(o)||(o=[]),o.length===1&&$(o[0],k)===1&&(o=[]);const P=r.value,E=m.value,Z=y(o[0]||k,P,E?T?E:Se(E):void 0),R=y(o[1]||(T?k:xe(k)),P?T?P:xe(P):void 0);return[Z,R]}return u==="multiple"?Array.isArray(o)?o.map(P=>y(P)):[y(k)]:((!o||Array.isArray(o))&&(o=k),y(o))},D=()=>{const o=Array.isArray(s.value)?s.value[0]:s.value;return o||y(re())};let h;const b=F(),s=F(x()),C=F(D()),d=F(),[w,I]=Rt(),M=S(()=>e.firstDayOfWeek?+e.firstDayOfWeek%7:0),B=S(()=>{const o=[];if(!r.value||!m.value)return o;const u=new Date(r.value);u.setDate(1);do o.push(new Date(u)),u.setMonth(u.getMonth()+1);while(te(u,m.value)!==1);return o}),_=S(()=>{if(s.value){if(e.type==="range")return!s.value[0]||!s.value[1];if(e.type==="multiple")return!s.value.length}return!s.value}),z=()=>s.value,Y=()=>{const o=xt(b.value),u=o+h,T=B.value.map((R,U)=>w.value[U].getHeight()),k=T.reduce((R,U)=>R+U,0);if(u>k&&o>0)return;let P=0,E;const Z=[-1,-1];for(let R=0;R<B.value.length;R++){const U=w.value[R];P<=u&&P+T[R]>=o&&(Z[1]=R,E||(E=U,Z[0]=R),w.value[R].showed||(w.value[R].showed=!0,n("monthShow",{date:U.date,title:U.getTitle()}))),P+=T[R]}B.value.forEach((R,U)=>{const Ee=U>=Z[0]-1&&U<=Z[1]+1;w.value[U].setVisible(Ee)}),E&&(d.value=E)},V=o=>{l.value?C.value=o:be(()=>{B.value.some((u,T)=>te(u,o)===0?(b.value&&w.value[T].scrollToDate(b.value,o),!0):!1),Y()})},L=()=>{if(!(e.poppable&&!e.show))if(s.value){const o=e.type==="single"?s.value:s.value[0];ke(o)&&V(o)}else l.value||be(Y)},W=()=>{e.poppable&&!e.show||(l.value||be(()=>{h=Math.floor(we(b).height)}),L())},H=(o=x())=>{s.value=o,L()},X=o=>{const{maxRange:u,rangePrompt:T,showRangePrompt:k}=e;return u&&en(o)>+u?(k&&$e(T||Q("rangePrompt",u)),n("overRange"),!1):!0},c=o=>{C.value=o,n("panelChange",{date:o})},v=()=>{var o;return n("confirm",(o=s.value)!=null?o:We(s.value))},a=(o,u)=>{const T=k=>{s.value=k,n("select",We(k))};if(u&&e.type==="range"&&!X(o)){T([o[0],Re(o[0],+e.maxRange-1)]);return}T(o),u&&!e.showConfirm&&v()},i=(o,u,T)=>{var k;return(k=o.find(P=>$(u,P.date)===-1&&$(P.date,T)===-1))==null?void 0:k.date},g=S(()=>w.value.reduce((o,u)=>{var T,k;return o.push(...(k=(T=u.disabledDays)==null?void 0:T.value)!=null?k:[]),o},[])),A=o=>{if(e.readonly||!o.date)return;const{date:u}=o,{type:T}=e;if(T==="range"){if(!s.value){a([u]);return}const[k,P]=s.value;if(k&&!P){const E=$(u,k);if(E===1){const Z=i(g.value,k,u);if(Z){const R=Se(Z);$(k,R)===-1?a([k,R]):a([u])}else a([k,u],!0)}else E===-1?a([u]):e.allowSameDay&&a([u,u],!0)}else a([u])}else if(T==="multiple"){if(!s.value){a([u]);return}const k=s.value,P=k.findIndex(E=>$(E,u)===0);if(P!==-1){const[E]=k.splice(P,1);n("unselect",oe(E))}else e.maxRange&&k.length>=+e.maxRange?$e(e.rangePrompt||Q("rangePrompt",e.maxRange)):a([...k,u])}else a(u,!0)},K=o=>n("clickOverlay",o),he=o=>n("update:show",o),Be=(o,u)=>{const T=u!==0||!e.showSubtitle;return f(sn,Me({ref:l.value?d:I(u),date:o,currentDate:s.value,showMonthTitle:T,firstDayOfWeek:M.value,lazyRender:l.value?!1:e.lazyRender,maxDate:m.value,minDate:r.value},p(e,["type","color","showMark","formatter","rowHeight","showSubtitle","allowSameDay"]),{onClick:A,onClickDisabledDate:k=>n("clickDisabledDate",k)}),p(t,["top-info","bottom-info","month-title","text"]))},lt=()=>{if(t.footer)return t.footer();if(e.showConfirm){const o=t["confirm-text"],u=_.value,T=u?e.confirmDisabledText:e.confirmText;return f(It,{round:!0,block:!0,type:"primary",color:e.color,class:O("confirm"),disabled:u,nativeType:"button",onClick:v},{default:()=>[o?o({disabled:u}):T||Q("confirm")]})}},it=()=>f("div",{class:[O("footer"),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[lt()]),_e=()=>{var o,u;return f("div",{class:O()},[f(dn,{date:(o=d.value)==null?void 0:o.date,maxDate:m.value,minDate:r.value,title:e.title,subtitle:(u=d.value)==null?void 0:u.getTitle(),showTitle:e.showTitle,showSubtitle:e.showSubtitle,switchMode:e.switchMode,firstDayOfWeek:M.value,onClickSubtitle:T=>n("clickSubtitle",T),onPanelChange:c},p(t,["title","subtitle","prev-month","prev-year","next-month","next-year"])),f("div",{ref:b,class:O("body"),onScroll:l.value?void 0:Y},[l.value?Be(C.value,0):B.value.map(Be)]),it()])};return J(()=>e.show,W),J(()=>[e.type,e.minDate,e.maxDate,e.switchMode],()=>H(x(s.value))),J(()=>e.defaultDate,o=>{H(o)}),fe({reset:H,scrollToDate:V,getSelectedDate:z}),Tt(W),()=>e.poppable?f(St,{show:e.show,class:O("popup"),round:e.round,position:e.position,closeable:e.showTitle||e.showSubtitle,teleport:e.teleport,closeOnPopstate:e.closeOnPopstate,safeAreaInsetTop:e.safeAreaInsetTop,closeOnClickOverlay:e.closeOnClickOverlay,onClickOverlay:K,"onUpdate:show":he},{default:_e}):_e()}});const Mn=me(mn);export{Mn as C,wn as P,Tn as R,an as a,Dn as b,kn as c,On as f,Cn as g,xn as p,Sn as s};
