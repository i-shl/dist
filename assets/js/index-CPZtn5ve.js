import{i as D,j as Y,n as M,m as q,d as $,k as J,l as G,e as r,p as T,I as O,q as X,r as Oe,s as $e,v as ze,x as qe,y as Ne,z as Ge,A as P,B as fe,C as w,D as N,E as ge,F as me,G as be,H as U,J as Fe,K as We,L as je,M as p,N as Ue,O as Ke,P as oe,h as z,Q as H,R as He,S as Ye,T as Je,U as Xe,V as Qe,W as Ze,X as pe,Y as et,Z as tt,u as nt,_ as at,f as lt,c as it,a as B,w as ee,o as rt,t as ot,$ as st,a0 as se}from"./index-WS9j5wCP.js";import{u as ct,r as ut,B as dt}from"./index-CogENnHs.js";import{u as ft,_ as gt}from"./_plugin-vue_export-helper-BiBEpKcN.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"051ca6428b97c6d36ca483b6bd6aaeed95b441f8"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="47f1398e-e4bb-48be-af36-a063b45101dd",e._sentryDebugIdIdentifier="sentry-dbid-47f1398e-e4bb-48be-af36-a063b45101dd")})()}catch{}const[mt,A]=G("cell"),he={tag:q("div"),icon:String,size:String,title:M,value:M,label:M,center:Boolean,isLink:Boolean,border:Y,iconPrefix:String,valueClass:D,labelClass:D,titleClass:D,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},bt=J({},he,ut);var ht=$({name:mt,props:bt,setup(e,{slots:n}){const o=ct(),d=()=>{if(n.label||T(e.label))return r("div",{class:[A("label"),e.labelClass]},[n.label?n.label():e.label])},a=()=>{var s;if(n.title||T(e.title)){const b=(s=n.title)==null?void 0:s.call(n);return Array.isArray(b)&&b.length===0?void 0:r("div",{class:[A("title"),e.titleClass],style:e.titleStyle},[b||r("span",null,[e.title]),d()])}},i=()=>{const s=n.value||n.default;if(s||T(e.value))return r("div",{class:[A("value"),e.valueClass]},[s?s():r("span",null,[e.value])])},C=()=>{if(n.icon)return n.icon();if(e.icon)return r(O,{name:e.icon,class:A("left-icon"),classPrefix:e.iconPrefix},null)},m=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const s=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return r(O,{name:s,class:A("right-icon")},null)}};return()=>{var s;const{tag:b,size:f,center:g,border:l,isLink:V,required:k}=e,v=(s=e.clickable)!=null?s:V,I={center:g,required:!!k,clickable:v,borderless:!l};return f&&(I[f]=!!f),r(b,{class:A(I),role:v?"button":void 0,tabindex:v?0:void 0,onClick:o},{default:()=>{var S;return[C(),a(),i(),m(),(S=n.extra)==null?void 0:S.call(n)]}})}}});const vt=X(ht);function ve(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function yt(e,n){if(ve(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function kt(e,n){return new Promise(o=>{const d=n.validator(e,n);if(Ne(d)){d.then(o);return}o(d)})}function ce(e,n){const{message:o}=n;return qe(o)?o(e,n):o||""}function St({target:e}){e.composing=!0}function ue({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Ct(e,n){const o=Oe();e.style.height="auto";let d=e.scrollHeight;if($e(n)){const{maxHeight:a,minHeight:i}=n;a!==void 0&&(d=Math.min(d,a)),i!==void 0&&(d=Math.max(d,i))}d&&(e.style.height=`${d}px`,ze(o))}function Vt(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function K(e){return[...e].length}function te(e,n){return[...e].slice(0,n).join("")}const[xt,x]=G("field"),_t={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:M,max:Number,min:Number,formatter:Function,clearIcon:q("clear"),modelValue:Ue(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:q("focus"),formatTrigger:q("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},wt=J({},he,_t,{rows:M,type:q("text"),rules:Array,autosize:[Boolean,Object],labelWidth:M,labelClass:D,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var It=$({name:xt,props:wt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:o}){const d=ft(),a=Ge({status:"unvalidated",focused:!1,validateMessage:""}),i=P(),C=P(),m=P(),{parent:s}=fe(Ke),b=()=>{var t;return String((t=e.modelValue)!=null?t:"")},f=t=>{if(T(e[t]))return e[t];if(s&&T(s.props[t]))return s.props[t]},g=w(()=>{const t=f("readonly");if(e.clearable&&!t){const c=b()!=="",u=e.clearTrigger==="always"||e.clearTrigger==="focus"&&a.focused;return c&&u}return!1}),l=w(()=>m.value&&o.input?m.value():e.modelValue),V=w(()=>{var t;const c=f("required");return c==="auto"?(t=e.rules)==null?void 0:t.some(u=>u.required):c}),k=t=>t.reduce((c,u)=>c.then(()=>{if(a.status==="failed")return;let{value:h}=l;if(u.formatter&&(h=u.formatter(h,u)),!yt(h,u)){a.status="failed",a.validateMessage=ce(h,u);return}if(u.validator)return ve(h)&&u.validateEmpty===!1?void 0:kt(h,u).then(y=>{y&&typeof y=="string"?(a.status="failed",a.validateMessage=y):y===!1&&(a.status="failed",a.validateMessage=ce(h,u))})}),Promise.resolve()),v=()=>{a.status="unvalidated",a.validateMessage=""},I=()=>n("endValidate",{status:a.status,message:a.validateMessage}),S=(t=e.rules)=>new Promise(c=>{v(),t?(n("startValidate"),k(t).then(()=>{a.status==="failed"?(c({name:e.name,message:a.validateMessage}),I()):(a.status="passed",c(),I())})):c()}),Q=t=>{if(s&&e.rules){const{validateTrigger:c}=s.props,u=oe(c).includes(t),h=e.rules.filter(y=>y.trigger?oe(y.trigger).includes(t):u);h.length&&S(h)}},ke=t=>{var c;const{maxlength:u}=e;if(T(u)&&K(t)>+u){const h=b();if(h&&K(h)===+u)return h;const y=(c=i.value)==null?void 0:c.selectionEnd;if(a.focused&&y){const L=[...t],R=L.length-+u;return L.splice(y-R,R),L.join("")}return te(t,+u)}return t},F=(t,c="onChange")=>{var u,h;const y=t;t=ke(t);const L=y.length-t.length;if(e.type==="number"||e.type==="digit"){const E=e.type==="number";if(t=We(t,E,E),c==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const _=je(+t,(u=e.min)!=null?u:-1/0,(h=e.max)!=null?h:1/0);+t!==_&&(t=_.toString())}}let R=0;if(e.formatter&&c===e.formatTrigger){const{formatter:E,maxlength:_}=e;if(t=E(t),T(_)&&K(t)>+_&&(t=te(t,+_)),i.value&&a.focused){const{selectionEnd:j}=i.value,re=te(y,j);R=E(re).length-re.length}}if(i.value&&i.value.value!==t)if(a.focused){let{selectionStart:E,selectionEnd:_}=i.value;if(i.value.value=t,T(E)&&T(_)){const j=t.length;L?(E-=L,_-=L):R&&(E+=R,_+=R),i.value.setSelectionRange(Math.min(E,j),Math.min(_,j))}}else i.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},Se=t=>{t.target.composing||F(t.target.value)},Z=()=>{var t;return(t=i.value)==null?void 0:t.blur()},ne=()=>{var t;return(t=i.value)==null?void 0:t.focus()},W=()=>{const t=i.value;e.type==="textarea"&&e.autosize&&t&&Ct(t,e.autosize)},Ce=t=>{a.focused=!0,n("focus",t),U(W),f("readonly")&&Z()},Ve=t=>{a.focused=!1,F(b(),"onBlur"),n("blur",t),!f("readonly")&&(Q("onBlur"),U(W),He())},ae=t=>n("clickInput",t),xe=t=>n("clickLeftIcon",t),_e=t=>n("clickRightIcon",t),we=t=>{p(t),n("update:modelValue",""),n("clear",t)},le=w(()=>{if(typeof e.error=="boolean")return e.error;if(s&&s.props.showError&&a.status==="failed")return!0}),Ie=w(()=>{const t=f("labelWidth"),c=f("labelAlign");if(t&&c!=="top")return{width:N(t)}}),Ee=t=>{t.keyCode===13&&(!(s&&s.props.submitOnEnter)&&e.type!=="textarea"&&p(t),e.type==="search"&&Z()),n("keypress",t)},ie=()=>e.id||`${d}-input`,Pe=()=>a.status,Te=()=>{const t=x("control",[f("inputAlign"),{error:le.value,custom:!!o.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(o.input)return r("div",{class:t,onClick:ae},[o.input()]);const c={id:ie(),ref:i,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:f("disabled"),readonly:f("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${d}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:Ve,onFocus:Ce,onInput:Se,onClick:ae,onChange:ue,onKeypress:Ee,onCompositionend:ue,onCompositionstart:St};return e.type==="textarea"?r("textarea",H(c,{inputmode:e.inputmode}),null):r("input",H(Vt(e.type,e.inputmode),c),null)},Be=()=>{const t=o["left-icon"];if(e.leftIcon||t)return r("div",{class:x("left-icon"),onClick:xe},[t?t():r(O,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Le=()=>{const t=o["right-icon"];if(e.rightIcon||t)return r("div",{class:x("right-icon"),onClick:_e},[t?t():r(O,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Re=()=>{if(e.showWordLimit&&e.maxlength){const t=K(b());return r("div",{class:x("word-limit")},[r("span",{class:x("word-num")},[t]),z("/"),e.maxlength])}},Me=()=>{if(s&&s.props.showErrorMessage===!1)return;const t=e.errorMessage||a.validateMessage;if(t){const c=o["error-message"],u=f("errorMessageAlign");return r("div",{class:x("error-message",u)},[c?c({message:t}):t])}},Ae=()=>{const t=f("labelWidth"),c=f("labelAlign"),u=f("colon")?":":"";if(o.label)return[o.label(),u];if(e.label)return r("label",{id:`${d}-label`,for:o.input?void 0:ie(),"data-allow-mismatch":"attribute",onClick:h=>{p(h),ne()},style:c==="top"&&t?{width:N(t)}:void 0},[e.label+u])},De=()=>[r("div",{class:x("body")},[Te(),g.value&&r(O,{ref:C,name:e.clearIcon,class:x("clear")},null),Le(),o.button&&r("div",{class:x("button")},[o.button()])]),Re(),Me()];return ge({blur:Z,focus:ne,validate:S,formValue:l,resetValidation:v,getValidationStatus:Pe}),Ye(Je,{customValue:m,resetValidation:v,validateWithTrigger:Q}),me(()=>e.modelValue,()=>{F(b()),v(),Q("onChange"),U(W)}),be(()=>{F(b(),e.formatTrigger),U(W)}),Fe("touchstart",we,{target:w(()=>{var t;return(t=C.value)==null?void 0:t.$el})}),()=>{const t=f("disabled"),c=f("labelAlign"),u=Be(),h=()=>{const y=Ae();return c==="top"?[u,y].filter(Boolean):y||[]};return r(vt,{size:e.size,class:x({error:le.value,disabled:t,[`label-${c}`]:c}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Ie.value,valueClass:x("value"),titleClass:[x("label",[c,{required:V.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:u&&c!=="top"?()=>u:null,title:h,value:De,extra:o.extra})}}});const Et=X(It),[Pt]=G("checkbox-group"),Tt=Symbol(Pt),ye={name:D,disabled:Boolean,iconSize:M,modelValue:D,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var Bt=$({props:J({},ye,{bem:Xe(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:Y,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:n,slots:o}){const d=P(),a=l=>{if(e.parent&&e.bindGroup)return e.parent.props[l]},i=w(()=>{if(e.parent&&e.bindGroup){const l=a("disabled")||e.disabled;if(e.role==="checkbox"){const V=a("modelValue").length,k=a("max"),v=k&&V>=+k;return l||v&&!e.checked}return l}return e.disabled}),C=w(()=>a("direction")),m=w(()=>{const l=e.checkedColor||a("checkedColor");if(l&&(e.checked||e.indeterminate)&&!i.value)return{borderColor:l,backgroundColor:l}}),s=w(()=>e.shape||a("shape")||"round"),b=l=>{const{target:V}=l,k=d.value,v=k===V||k?.contains(V);!i.value&&(v||!e.labelDisabled)&&n("toggle"),n("click",l)},f=()=>{var l,V;const{bem:k,checked:v,indeterminate:I}=e,S=e.iconSize||a("iconSize");return r("div",{ref:d,class:k("icon",[s.value,{disabled:i.value,checked:v,indeterminate:I}]),style:s.value!=="dot"?{fontSize:N(S)}:{width:N(S),height:N(S),borderColor:(l=m.value)==null?void 0:l.borderColor}},[o.icon?o.icon({checked:v,disabled:i.value}):s.value!=="dot"?r(O,{name:I?"minus":"success",style:m.value},null):r("div",{class:k("icon--dot__icon"),style:{backgroundColor:(V=m.value)==null?void 0:V.backgroundColor}},null)])},g=()=>{const{checked:l}=e;if(o.default)return r("span",{class:e.bem("label",[e.labelPosition,{disabled:i.value}])},[o.default({checked:l,disabled:i.value})])};return()=>{const l=e.labelPosition==="left"?[g(),f()]:[f(),g()];return r("div",{role:e.role,class:e.bem([{disabled:i.value,"label-disabled":e.labelDisabled},C.value]),tabindex:i.value?void 0:0,"aria-checked":e.checked,onClick:b},[l])}}});const[Lt,Rt]=G("checkbox"),Mt=J({},ye,{shape:String,bindGroup:Y,indeterminate:{type:Boolean,default:null}});var At=$({name:Lt,props:Mt,emits:["change","update:modelValue"],setup(e,{emit:n,slots:o}){const{parent:d}=fe(Tt),a=m=>{const{name:s}=e,{max:b,modelValue:f}=d.props,g=f.slice();if(m)!(b&&g.length>=+b)&&!g.includes(s)&&(g.push(s),e.bindGroup&&d.updateValue(g));else{const l=g.indexOf(s);l!==-1&&(g.splice(l,1),e.bindGroup&&d.updateValue(g))}},i=w(()=>d&&e.bindGroup?d.props.modelValue.indexOf(e.name)!==-1:!!e.modelValue),C=(m=!i.value)=>{d&&e.bindGroup?a(m):n("update:modelValue",m),e.indeterminate!==null&&n("change",m)};return me(()=>e.modelValue,m=>{e.indeterminate===null&&n("change",m)}),ge({toggle:C,props:e,checked:i}),Qe(()=>e.modelValue),()=>r(Bt,H({bem:Rt,role:"checkbox",parent:d,checked:i.value,onToggle:C},e),Ze(o,["default","icon"]))}});const Dt=X(At),[Ot,de]=G("cell-group"),$t={title:String,inset:Boolean,border:Y};var zt=$({name:Ot,inheritAttrs:!1,props:$t,setup(e,{slots:n,attrs:o}){const d=()=>{var i;return r("div",H({class:[de({inset:e.inset}),{[tt]:e.border&&!e.inset}]},o,et()),[(i=n.default)==null?void 0:i.call(n)])},a=()=>r("div",{class:de("title",{inset:e.inset})},[n.title?n.title():e.title]);return()=>e.title||n.title?r(pe,null,[a(),d()]):d()}});const qt=X(zt),Nt={class:"login-container"},Gt={class:"login-options"},Ft=$({__name:"index",setup(e){const n=lt(),o=at(),d=nt(),a=P(""),i=P(""),C=P(!1),m=P(!1),s=P(""),b=P("");be(()=>{if(d.isLogin){const g=o.query.redirect||"/";n.replace(g)}else{const g=localStorage.getItem("username");g&&(a.value=g,C.value=!0)}});const f=async()=>{if(s.value="",b.value="",!a.value){s.value="请输入账号";return}if(!i.value){b.value="请输入密码";return}m.value=!0;try{const g=await st({username:a.value,password:i.value});d.setToken(g.token),C.value?localStorage.setItem("username",a.value):localStorage.removeItem("username"),se({type:"success",message:"登录成功！"});const l=o.query.redirect||"/";n.replace(l)}catch(g){se({type:"fail",message:"登录失败："+(g?.message||"未知错误")})}finally{m.value=!1}};return(g,l)=>{const V=Et,k=Dt,v=dt,I=qt;return rt(),it("div",Nt,[l[4]||(l[4]=B("div",{class:"login-header"},[B("h1",null,"欢迎登录"),B("p",{class:"subtitle"},"请输入您的账号和密码")],-1)),r(I,{inset:""},{default:ee(()=>[r(V,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=S=>a.value=S),label:"账号",placeholder:"请输入手机号/邮箱",required:"","error-message":s.value,clearable:""},null,8,["modelValue","error-message"]),r(V,{modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=S=>i.value=S),type:"password",label:"密码",placeholder:"请输入密码",required:"","error-message":b.value,clearable:""},null,8,["modelValue","error-message"]),B("div",Gt,[r(k,{modelValue:C.value,"onUpdate:modelValue":l[2]||(l[2]=S=>C.value=S)},{default:ee(()=>[...l[3]||(l[3]=[z("记住账号",-1)])]),_:1},8,["modelValue"])]),r(v,{block:"",type:"primary",loading:m.value,onClick:f},{default:ee(()=>[z(ot(m.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1}),l[5]||(l[5]=B("div",{class:"footer"},[B("p",{class:"privacy"},[z(" 登录即表示同意 "),B("a",{href:"#"},"《用户协议》"),z(" 和 "),B("a",{href:"#"},"《隐私政策》")])],-1))])}}}),Kt=gt(Ft,[["__scopeId","data-v-2c285274"]]);export{Kt as default};
