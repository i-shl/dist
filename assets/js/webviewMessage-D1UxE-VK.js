import{a2 as r}from"./index-vK4NfPWv.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"051ca6428b97c6d36ca483b6bd6aaeed95b441f8"}}catch{}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="ec2607bf-ee54-4116-9e7c-a2d463d800b5",n._sentryDebugIdIdentifier="sentry-dbid-ec2607bf-ee54-4116-9e7c-a2d463d800b5")})()}catch{}function i(){const n=r();return["mp-weixin","mp-qiwei","mp-lark"].includes(n.env)}function a(){return new Promise(n=>{if(typeof window<"u"&&window.uni&&window.uni.webView&&typeof window.uni.webView.postMessage=="function"){n();return}const e=()=>{typeof window<"u"&&window.uni&&window.uni.webView&&typeof window.uni.webView.postMessage=="function"&&n()};e(),document.addEventListener("UniAppJSBridgeReady",e,{once:!0}),setTimeout(()=>{document.removeEventListener("UniAppJSBridgeReady",e),n()},5e3)})}async function s(n){try{if(!i())return console.warn("当前不在小程序环境中，无法发送消息"),!1;await a();const e=window.uni;if(!e||!e.webView||typeof e.webView.postMessage!="function")return console.warn("uni.webView.postMessage 不可用，请确保已加载 uni.webview.js"),console.log("当前 uni 对象:",e),!1;try{return e.webView.postMessage({data:n}),console.log("✅ 消息已通过 uni.webView.postMessage 发送到小程序:",n),console.warn("⚠️ 注意：微信小程序的 message 事件仅在特定时机触发（后退、销毁、分享），不会立即触发"),!0}catch(o){return console.error("❌ uni.webView.postMessage 发送失败:",o),!1}}catch(e){return console.error("发送消息失败:",e),!1}}async function c(n){return await s({action:"test",page:n,timestamp:Date.now(),message:`来自 ${n} 页面的测试消息`})}function t(){if(typeof window<"u"&&window.uni)return window.uni;if(typeof globalThis<"u"&&globalThis.uni)return globalThis.uni}function f(n="/home"){if(!i())return console.warn("当前不在小程序环境中，无法调用 uni.navigateTo"),!1;const e=t();if(!e||typeof e.navigateTo!="function")return console.warn("uni.navigateTo 不可用"),!1;try{return e.navigateTo({url:n}),console.log("✅ uni.navigateTo 调用成功:",n),!0}catch(o){return console.error("❌ uni.navigateTo 调用失败:",o),!1}}function w(n="/home"){if(!i())return console.warn("当前不在小程序环境中，无法调用 uni.redirectTo"),!1;const e=t();if(!e||typeof e.redirectTo!="function")return console.warn("uni.redirectTo 不可用"),!1;try{return e.redirectTo({url:n}),console.log("✅ uni.redirectTo 调用成功:",n),!0}catch(o){return console.error("❌ uni.redirectTo 调用失败:",o),!1}}function d(n="/home"){if(!i())return console.warn("当前不在小程序环境中，无法调用 uni.reLaunch"),!1;const e=t();if(!e||typeof e.reLaunch!="function")return console.warn("uni.reLaunch 不可用"),!1;try{return e.reLaunch({url:n}),console.log("✅ uni.reLaunch 调用成功:",n),!0}catch(o){return console.error("❌ uni.reLaunch 调用失败:",o),!1}}function l(n="/home"){if(!i())return console.warn("当前不在小程序环境中，无法调用 uni.switchTab"),!1;const e=t();if(!e||typeof e.switchTab!="function")return console.warn("uni.switchTab 不可用"),!1;try{return e.switchTab({url:n}),console.log("✅ uni.switchTab 调用成功:",n),!0}catch(o){return console.error("❌ uni.switchTab 调用失败:",o),!1}}function g(n=1){if(!i())return console.warn("当前不在小程序环境中，无法调用 uni.navigateBack"),!1;const e=t();if(!e||typeof e.navigateBack!="function")return console.warn("uni.navigateBack 不可用"),!1;try{return e.navigateBack(),console.log("✅ uni.navigateBack 调用成功, delta:",n),!0}catch(o){return console.error("❌ uni.navigateBack 调用失败:",o),!1}}export{s as a,w as b,d as c,l as d,g as e,c as s,f as t};
