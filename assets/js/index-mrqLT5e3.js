import{g as Re,i as Ae,s as De,f as ze,h as Oe,d as W,j as Q,k as Z,r as Ne,l as E,m as se,n as w,p as A,q as ce,t as ue,v as de,x as N,y as qe,b as u,z as L,A as Ge,B as Fe,C as K,I as G,D as F,E as $e,F as $,G as J,H as We,J as le,K as R,L as X,M as je,N as Ue,O as Ke,P as fe,Q as ge,R as He,S as Ye,T as Je,U as Xe,V as Qe,u as Ze,c as pe,a as P,w as H,o as et,W as tt,X as nt,Y as oe}from"./index-B9PYyCw2.js";import{a as at,c as lt,C as ot}from"./index-DLChmI8s.js";import{_ as it}from"./_plugin-vue_export-helper-BkUkw1eH.js";import{B as rt}from"./index-C9a1Uxhy.js";import{u as st}from"./use-id-C_khwp0y.js";import"./use-route-oD16A86L.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"9bd7e4cba8ae5d14e2697cf76fc4a99999e3d54b"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="44f64eb3-7607-40d9-967c-af363310b20a",e._sentryDebugIdIdentifier="sentry-dbid-44f64eb3-7607-40d9-967c-af363310b20a")})()}catch{}function me(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function ct(e,n){if(me(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function ut(e,n){return new Promise(s=>{const c=n.validator(e,n);if(Oe(c)){c.then(s);return}s(c)})}function ie(e,n){const{message:s}=n;return ze(s)?s(e,n):s||""}function dt({target:e}){e.composing=!0}function re({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function ft(e,n){const s=Re();e.style.height="auto";let c=e.scrollHeight;if(Ae(n)){const{maxHeight:a,minHeight:i}=n;a!==void 0&&(c=Math.min(c,a)),i!==void 0&&(c=Math.max(c,i))}c&&(e.style.height=`${c}px`,De(s))}function gt(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function q(e){return[...e].length}function Y(e,n){return[...e].slice(0,n).join("")}const[mt,x]=Z("field"),bt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:$,max:Number,min:Number,formatter:Function,clearIcon:F("clear"),modelValue:$e(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:F("focus"),formatTrigger:F("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},ht=Q({},lt,bt,{rows:$,type:F("text"),rules:Array,autosize:[Boolean,Object],labelWidth:$,labelClass:J,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var vt=W({name:mt,props:ht,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:s}){const c=st(),a=Ne({status:"unvalidated",focused:!1,validateMessage:""}),i=E(),S=E(),b=E(),{parent:d}=se(We),v=()=>{var t;return String((t=e.modelValue)!=null?t:"")},f=t=>{if(L(e[t]))return e[t];if(d&&L(d.props[t]))return d.props[t]},g=w(()=>{const t=f("readonly");if(e.clearable&&!t){const o=v()!=="",r=e.clearTrigger==="always"||e.clearTrigger==="focus"&&a.focused;return o&&r}return!1}),l=w(()=>b.value&&s.input?b.value():e.modelValue),V=w(()=>{var t;const o=f("required");return o==="auto"?(t=e.rules)==null?void 0:t.some(r=>r.required):o}),y=t=>t.reduce((o,r)=>o.then(()=>{if(a.status==="failed")return;let{value:m}=l;if(r.formatter&&(m=r.formatter(m,r)),!ct(m,r)){a.status="failed",a.validateMessage=ie(m,r);return}if(r.validator)return me(m)&&r.validateEmpty===!1?void 0:ut(m,r).then(h=>{h&&typeof h=="string"?(a.status="failed",a.validateMessage=h):h===!1&&(a.status="failed",a.validateMessage=ie(m,r))})}),Promise.resolve()),k=()=>{a.status="unvalidated",a.validateMessage=""},T=()=>n("endValidate",{status:a.status,message:a.validateMessage}),C=(t=e.rules)=>new Promise(o=>{k(),t?(n("startValidate"),y(t).then(()=>{a.status==="failed"?(o({name:e.name,message:a.validateMessage}),T()):(a.status="passed",o(),T())})):o()}),j=t=>{if(d&&e.rules){const{validateTrigger:o}=d.props,r=le(o).includes(t),m=e.rules.filter(h=>h.trigger?le(h.trigger).includes(t):r);m.length&&C(m)}},he=t=>{var o;const{maxlength:r}=e;if(L(r)&&q(t)>+r){const m=v();if(m&&q(m)===+r)return m;const h=(o=i.value)==null?void 0:o.selectionEnd;if(a.focused&&h){const B=[...t],M=B.length-+r;return B.splice(h-M,M),B.join("")}return Y(t,+r)}return t},D=(t,o="onChange")=>{var r,m;const h=t;t=he(t);const B=h.length-t.length;if(e.type==="number"||e.type==="digit"){const _=e.type==="number";if(t=Ge(t,_,_),o==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const I=Fe(+t,(r=e.min)!=null?r:-1/0,(m=e.max)!=null?m:1/0);+t!==I&&(t=I.toString())}}let M=0;if(e.formatter&&o===e.formatTrigger){const{formatter:_,maxlength:I}=e;if(t=_(t),L(I)&&q(t)>+I&&(t=Y(t,+I)),i.value&&a.focused){const{selectionEnd:O}=i.value,ae=Y(h,O);M=_(ae).length-ae.length}}if(i.value&&i.value.value!==t)if(a.focused){let{selectionStart:_,selectionEnd:I}=i.value;if(i.value.value=t,L(_)&&L(I)){const O=t.length;B?(_-=B,I-=B):M&&(_+=M,I+=M),i.value.setSelectionRange(Math.min(_,O),Math.min(I,O))}}else i.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},ve=t=>{t.target.composing||D(t.target.value)},U=()=>{var t;return(t=i.value)==null?void 0:t.blur()},p=()=>{var t;return(t=i.value)==null?void 0:t.focus()},z=()=>{const t=i.value;e.type==="textarea"&&e.autosize&&t&&ft(t,e.autosize)},ye=t=>{a.focused=!0,n("focus",t),N(z),f("readonly")&&U()},ke=t=>{a.focused=!1,D(v(),"onBlur"),n("blur",t),!f("readonly")&&(j("onBlur"),N(z),je())},ee=t=>n("clickInput",t),Se=t=>n("clickLeftIcon",t),Ve=t=>n("clickRightIcon",t),Ce=t=>{K(t),n("update:modelValue",""),n("clear",t)},te=w(()=>{if(typeof e.error=="boolean")return e.error;if(d&&d.props.showError&&a.status==="failed")return!0}),xe=w(()=>{const t=f("labelWidth"),o=f("labelAlign");if(t&&o!=="top")return{width:A(t)}}),Ie=t=>{t.keyCode===13&&(!(d&&d.props.submitOnEnter)&&e.type!=="textarea"&&K(t),e.type==="search"&&U()),n("keypress",t)},ne=()=>e.id||`${c}-input`,we=()=>a.status,_e=()=>{const t=x("control",[f("inputAlign"),{error:te.value,custom:!!s.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(s.input)return u("div",{class:t,onClick:ee},[s.input()]);const o={id:ne(),ref:i,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:f("disabled"),readonly:f("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${c}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:ke,onFocus:ye,onInput:ve,onClick:ee,onChange:re,onKeypress:Ie,onCompositionend:re,onCompositionstart:dt};return e.type==="textarea"?u("textarea",X(o,{inputmode:e.inputmode}),null):u("input",X(gt(e.type,e.inputmode),o),null)},Ee=()=>{const t=s["left-icon"];if(e.leftIcon||t)return u("div",{class:x("left-icon"),onClick:Se},[t?t():u(G,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Pe=()=>{const t=s["right-icon"];if(e.rightIcon||t)return u("div",{class:x("right-icon"),onClick:Ve},[t?t():u(G,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Te=()=>{if(e.showWordLimit&&e.maxlength){const t=q(v());return u("div",{class:x("word-limit")},[u("span",{class:x("word-num")},[t]),R("/"),e.maxlength])}},Be=()=>{if(d&&d.props.showErrorMessage===!1)return;const t=e.errorMessage||a.validateMessage;if(t){const o=s["error-message"],r=f("errorMessageAlign");return u("div",{class:x("error-message",r)},[o?o({message:t}):t])}},Me=()=>{const t=f("labelWidth"),o=f("labelAlign"),r=f("colon")?":":"";if(s.label)return[s.label(),r];if(e.label)return u("label",{id:`${c}-label`,for:s.input?void 0:ne(),"data-allow-mismatch":"attribute",onClick:m=>{K(m),p()},style:o==="top"&&t?{width:A(t)}:void 0},[e.label+r])},Le=()=>[u("div",{class:x("body")},[_e(),g.value&&u(G,{ref:S,name:e.clearIcon,class:x("clear")},null),Pe(),s.button&&u("div",{class:x("button")},[s.button()])]),Te(),Be()];return ce({blur:U,focus:p,validate:C,formValue:l,resetValidation:k,getValidationStatus:we}),Ue(Ke,{customValue:b,resetValidation:k,validateWithTrigger:j}),ue(()=>e.modelValue,()=>{D(v()),k(),j("onChange"),N(z)}),de(()=>{D(v(),e.formatTrigger),N(z)}),qe("touchstart",Ce,{target:w(()=>{var t;return(t=S.value)==null?void 0:t.$el})}),()=>{const t=f("disabled"),o=f("labelAlign"),r=Ee(),m=()=>{const h=Me();return o==="top"?[r,h].filter(Boolean):h||[]};return u(at,{size:e.size,class:x({error:te.value,disabled:t,[`label-${o}`]:o}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:xe.value,valueClass:x("value"),titleClass:[x("label",[o,{required:V.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:r&&o!=="top"?()=>r:null,title:m,value:Le,extra:s.extra})}}});const yt=fe(vt),[kt]=Z("checkbox-group"),St=Symbol(kt),be={name:J,disabled:Boolean,iconSize:$,modelValue:J,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var Vt=W({props:Q({},be,{bem:He(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:ge,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:n,slots:s}){const c=E(),a=l=>{if(e.parent&&e.bindGroup)return e.parent.props[l]},i=w(()=>{if(e.parent&&e.bindGroup){const l=a("disabled")||e.disabled;if(e.role==="checkbox"){const V=a("modelValue").length,y=a("max"),k=y&&V>=+y;return l||k&&!e.checked}return l}return e.disabled}),S=w(()=>a("direction")),b=w(()=>{const l=e.checkedColor||a("checkedColor");if(l&&(e.checked||e.indeterminate)&&!i.value)return{borderColor:l,backgroundColor:l}}),d=w(()=>e.shape||a("shape")||"round"),v=l=>{const{target:V}=l,y=c.value,k=y===V||y?.contains(V);!i.value&&(k||!e.labelDisabled)&&n("toggle"),n("click",l)},f=()=>{var l,V;const{bem:y,checked:k,indeterminate:T}=e,C=e.iconSize||a("iconSize");return u("div",{ref:c,class:y("icon",[d.value,{disabled:i.value,checked:k,indeterminate:T}]),style:d.value!=="dot"?{fontSize:A(C)}:{width:A(C),height:A(C),borderColor:(l=b.value)==null?void 0:l.borderColor}},[s.icon?s.icon({checked:k,disabled:i.value}):d.value!=="dot"?u(G,{name:T?"minus":"success",style:b.value},null):u("div",{class:y("icon--dot__icon"),style:{backgroundColor:(V=b.value)==null?void 0:V.backgroundColor}},null)])},g=()=>{const{checked:l}=e;if(s.default)return u("span",{class:e.bem("label",[e.labelPosition,{disabled:i.value}])},[s.default({checked:l,disabled:i.value})])};return()=>{const l=e.labelPosition==="left"?[g(),f()]:[f(),g()];return u("div",{role:e.role,class:e.bem([{disabled:i.value,"label-disabled":e.labelDisabled},S.value]),tabindex:i.value?void 0:0,"aria-checked":e.checked,onClick:v},[l])}}});const[Ct,xt]=Z("checkbox"),It=Q({},be,{shape:String,bindGroup:ge,indeterminate:{type:Boolean,default:null}});var wt=W({name:Ct,props:It,emits:["change","update:modelValue"],setup(e,{emit:n,slots:s}){const{parent:c}=se(St),a=b=>{const{name:d}=e,{max:v,modelValue:f}=c.props,g=f.slice();if(b)!(v&&g.length>=+v)&&!g.includes(d)&&(g.push(d),e.bindGroup&&c.updateValue(g));else{const l=g.indexOf(d);l!==-1&&(g.splice(l,1),e.bindGroup&&c.updateValue(g))}},i=w(()=>c&&e.bindGroup?c.props.modelValue.indexOf(e.name)!==-1:!!e.modelValue),S=(b=!i.value)=>{c&&e.bindGroup?a(b):n("update:modelValue",b),e.indeterminate!==null&&n("change",b)};return ue(()=>e.modelValue,b=>{e.indeterminate===null&&n("change",b)}),ce({toggle:S,props:e,checked:i}),Ye(()=>e.modelValue),()=>u(Vt,X({bem:xt,role:"checkbox",parent:c,checked:i.value,onToggle:S},e),Je(s,["default","icon"]))}});const _t=fe(wt),Et={class:"login-container"},Pt={class:"login-options"},Tt=W({__name:"index",setup(e){const n=Ze(),s=Qe(),c=Xe(),a=E(""),i=E(""),S=E(!1),b=E(!1),d=E(""),v=E("");de(()=>{if(c.isLogin){const g=s.query.redirect||"/";n.replace(g)}else{const g=localStorage.getItem("username");g&&(a.value=g,S.value=!0)}});const f=async()=>{if(d.value="",v.value="",!a.value){d.value="请输入账号";return}if(!i.value){v.value="请输入密码";return}b.value=!0;try{const g=await nt({username:a.value,password:i.value});c.setToken(g.token),S.value?localStorage.setItem("username",a.value):localStorage.removeItem("username"),oe({type:"success",message:"登录成功！"});const l=s.query.redirect||"/";n.replace(l)}catch(g){oe({type:"fail",message:"登录失败："+(g?.message||"未知错误")})}finally{b.value=!1}};return(g,l)=>{const V=yt,y=_t,k=rt,T=ot;return et(),pe("div",Et,[l[4]||(l[4]=P("div",{class:"login-header"},[P("h1",null,"欢迎登录"),P("p",{class:"subtitle"},"请输入您的账号和密码")],-1)),u(T,{inset:""},{default:H(()=>[u(V,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=C=>a.value=C),label:"账号",placeholder:"请输入手机号/邮箱",required:"","error-message":d.value,clearable:""},null,8,["modelValue","error-message"]),u(V,{modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=C=>i.value=C),type:"password",label:"密码",placeholder:"请输入密码",required:"","error-message":v.value,clearable:""},null,8,["modelValue","error-message"]),P("div",Pt,[u(y,{modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=C=>S.value=C)},{default:H(()=>[...l[3]||(l[3]=[R("记住账号",-1)])]),_:1},8,["modelValue"])]),u(k,{block:"",type:"primary",loading:b.value,onClick:f},{default:H(()=>[R(tt(b.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1}),l[5]||(l[5]=P("div",{class:"footer"},[P("p",{class:"privacy"},[R(" 登录即表示同意 "),P("a",{href:"#"},"《用户协议》"),R(" 和 "),P("a",{href:"#"},"《隐私政策》")])],-1))])}}}),zt=it(Tt,[["__scopeId","data-v-fb950c82"]]);export{zt as default};
