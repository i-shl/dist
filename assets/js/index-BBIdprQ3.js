import{d as C,_ as h,r as l,a2 as k,v as I,z as E,p as S,X as s,a as d,s as g,A as f,x as B,C as D,bd as U,Z as _}from"./index-Dl01RQ6O.js";import{C as q}from"./index-mptTmHL0.js";import{C as L}from"./index-DEvwBoeL.js";import"./index-BqICLX6q.js";import"./index-BOjqb5K1.js";import{F as N}from"./index-eAYjl05a.js";import{B as R}from"./index-DOrlSKCD.js";import{_ as A}from"./_plugin-vue_export-helper-CbkZt4eH.js";import"./use-route-DZOD05gS.js";import"./use-id-BLwlvdqR.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};o.SENTRY_RELEASE={id:"dadf989baaa19ca9a7dda97cefda507d3b8f8f5a"}}catch{}})();try{(function(){var o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new o.Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="11a55627-cdaf-4b19-adb9-e4c33d09baa3",o._sentryDebugIdIdentifier="sentry-dbid-11a55627-cdaf-4b19-adb9-e4c33d09baa3")})()}catch{}const F={class:"login-container"},G={class:"login-options"},M=C({__name:"index",setup(o){const t=E(),b=I(),c=h(),r=l(""),u=l(""),i=l(!1),p=l(!1),m=l(""),v=l("");k(()=>{if(c.isLogin){const a=b.query.redirect||"/";t.replace(a)}else{const a=localStorage.getItem("username");a&&(r.value=a,i.value=!0)}});const w=async()=>{if(m.value="",v.value="",!r.value){m.value="请输入账号";return}if(!u.value){v.value="请输入密码";return}p.value=!0;try{const a=await U({username:r.value,password:u.value});c.setToken(a.token),a.userType&&c.setUserType(a.userType),i.value?localStorage.setItem("username",r.value):localStorage.removeItem("username"),_({type:"success",message:"登录成功！"});const e=b.query.redirect||"/";t.replace(e)}catch(a){_({type:"fail",message:"登录失败："+(a?.message||"未知错误")})}finally{p.value=!1}};return(a,e)=>{const y=N,V=L,T=R,x=q;return B(),S("div",F,[e[4]||(e[4]=s("div",{class:"login-header"},[s("h1",null,"欢迎登录"),s("p",{class:"subtitle"},"请输入您的账号和密码")],-1)),d(x,{inset:""},{default:g(()=>[d(y,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n),label:"账号",placeholder:"请输入手机号/邮箱",required:"","error-message":m.value,clearable:""},null,8,["modelValue","error-message"]),d(y,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),type:"password",label:"密码",placeholder:"请输入密码",required:"","error-message":v.value,clearable:""},null,8,["modelValue","error-message"]),s("div",G,[d(V,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=n=>i.value=n)},{default:g(()=>[...e[3]||(e[3]=[f("记住账号",-1)])]),_:1},8,["modelValue"])]),d(T,{block:"",type:"primary",loading:p.value,onClick:w},{default:g(()=>[f(D(p.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1}),e[5]||(e[5]=s("div",{class:"footer"},[s("p",{class:"privacy"},[f(" 登录即表示同意 "),s("a",{href:"#"},"《用户协议》"),f(" 和 "),s("a",{href:"#"},"《隐私政策》")])],-1))])}}}),Q=A(M,[["__scopeId","data-v-f42d859d"]]);export{Q as default};
