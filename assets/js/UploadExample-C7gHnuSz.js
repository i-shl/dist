import{d as x,r as f,o as I,p as V,a as m,Z as _,x as w,X as o,C as g,s as B,A as E}from"./index-BB40URPS.js";import{U as N}from"./index-BaN3w7lp.js";import{_ as h}from"./_plugin-vue_export-helper-CEDRTg0d.js";import{B as j}from"./index-Dr1M9peL.js";import"./index-M7bx6HKy.js";import"./use-route-Dff6YpaV.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"feac73d359e7bcd07886c4d68a714e6ac6d56310"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},d=new t.Error().stack;d&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[d]="6e0bb30d-6ed1-471d-a647-933ea249689b",t._sentryDebugIdIdentifier="sentry-dbid-6e0bb30d-6ed1-471d-a647-933ea249689b")})()}catch{}const A={class:"base-upload"},R=x({__name:"BaseUpload",props:{modelValue:{type:[String,Array],default:""},maxCount:{type:Number,default:1},maxSize:{type:Number,default:5},accept:{type:String,default:"image/*"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},beforeRead:{type:Function,default:void 0},upload:{type:Function,required:!0}},emits:["update:modelValue","change"],setup(t,{expose:d,emit:r}){const l=t,c=r,u=f([]),e=f();I(()=>l.modelValue,()=>{if(!l.modelValue){u.value=[];return}const n=Array.isArray(l.modelValue)?l.modelValue:[l.modelValue],s=u.value.filter(a=>a.status==="done"&&a.url).map(a=>a.url);JSON.stringify(n)!==JSON.stringify(s)&&(u.value=n.map(a=>({url:a,status:"done",message:"上传成功",isImage:!0})))},{immediate:!0});const i=async n=>{const s=Array.isArray(n)?n:[n];for(const a of s)if(a.file){a.status="uploading",a.message="上传中...";try{if(l.upload){const p=await l.upload(a.file);a.status="done",a.message="上传成功",a.url=p}else throw new Error("未提供 upload 方法")}catch(p){a.status="failed",a.message="上传失败",console.error("Upload failed:",p)}}b()},U=()=>{b()},b=()=>{const n=u.value.filter(a=>a.status==="done"&&a.url).map(a=>a.url);let s;l.maxCount===1?s=n[0]??"":s=n,c("update:modelValue",s),c("change",s)},S=()=>{_(`文件大小不能超过 ${l.maxSize}MB`)};return d({fileList:u,uploaderRef:e}),(n,s)=>{const a=N;return w(),V("div",A,[m(a,{ref_key:"uploaderRef",ref:e,modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=p=>u.value=p),"max-count":t.maxCount,"max-size":t.maxSize*1024*1024,accept:t.accept,disabled:t.disabled,readonly:t.readonly,deletable:!t.readonly,"preview-full-image":!0,"before-read":t.beforeRead,"after-read":i,onDelete:U,onOversize:S},null,8,["modelValue","max-count","max-size","accept","disabled","readonly","deletable","before-read"])])}}}),v=h(R,[["__scopeId","data-v-60c68bb9"]]),T={class:"upload-example-page"},k={class:"content"},C={class:"demo-card"},z={class:"upload-box"},D={class:"value-preview"},L={class:"demo-card"},F={class:"upload-box"},O={class:"value-preview"},$={class:"demo-card"},J={class:"upload-box"},M={class:"actions"},P=x({name:"UploadExample",__name:"UploadExample",setup(t){const d=f("https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"),r=f(["https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg","https://fastly.jsdelivr.net/npm/@vant/assets/tree.jpeg"]),l=u=>new Promise(e=>{setTimeout(()=>{e(`https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg?hash=${Math.random()}`)},1e3)}),c=()=>{console.log("Avatar URL:",d.value),console.log("Product Images:",r.value),_("提交成功，请查看控制台数据")};return(u,e)=>{const y=j;return w(),V("div",T,[o("div",k,[o("section",C,[e[3]||(e[3]=o("h3",null,"1. 单图上传 (头像)",-1)),e[4]||(e[4]=o("p",{class:"desc"},"v-model 绑定值为字符串，限制数量 1",-1)),o("div",z,[m(v,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=i=>d.value=i),"max-count":1,upload:l},null,8,["modelValue"])]),o("div",D,"当前值: "+g(d.value||"空"),1)]),o("section",L,[e[5]||(e[5]=o("h3",null,"2. 多图上传 (商品图)",-1)),e[6]||(e[6]=o("p",{class:"desc"},"v-model 绑定值为数组，限制数量 5",-1)),o("div",F,[m(v,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=i=>r.value=i),"max-count":5,upload:l},null,8,["modelValue"])]),o("div",O," 当前值: "+g(JSON.stringify(r.value,null,2)),1)]),o("section",$,[e[7]||(e[7]=o("h3",null,"3. 只读模式",-1)),o("div",J,[m(v,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=i=>r.value=i),readonly:"",upload:l},null,8,["modelValue"])])]),o("div",M,[m(y,{type:"primary",block:"",round:"",onClick:c},{default:B(()=>[...e[8]||(e[8]=[E(" 获取当前数据 ",-1)])]),_:1})])])])}}}),K=h(P,[["__scopeId","data-v-df243925"]]);export{K as default};
