import{d as R,t as q,M as J,m as C,c as M,r as y,a9 as A,i as Q,o as I,aa as Z,a4 as F,D as ee,ab as K,a as h,ac as N,ad as H,ae as te,af as U,w as Y,n as ae,E as le,ag as se,ah as ne,ai as oe,W as $,s as P,x as L,aj as V,p as j,F as ie,y as de,X as z,C as ue}from"./index-BNEumYnt.js";import{C as X}from"./index-CvfGFW36.js";import{E as re}from"./index-Drz8zGSH.js";import{u as ce}from"./use-tab-status-CjoRXsOl.js";import{_ as G}from"./_plugin-vue_export-helper-CEDRTg0d.js";import"./use-route-B7WKtoXO.js";import"./use-id-DNVwWoPK.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"feac73d359e7bcd07886c4d68a714e6ac6d56310"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new e.Error().stack;c&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[c]="d2f65d45-9647-496a-8d3c-544ea488be8a",e._sentryDebugIdIdentifier="sentry-dbid-d2f65d45-9647-496a-8d3c-544ea488be8a")})()}catch{}const[fe,D,me]=M("list"),he={error:Boolean,offset:C(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:J("down"),loadingText:{type:String,default:""},finishedText:String,immediateCheck:q};var ge=R({name:fe,props:he,emits:["load","update:error","update:loading"],setup(e,{emit:c,slots:d}){const l=y(e.loading),f=y(),u=y(),n=ce(),a=A(f),o=Q(()=>e.scroller||a.value),s=()=>{N(()=>{if(l.value||e.finished||e.disabled||e.error||n?.value===!1)return;const{direction:r}=e,p=+e.offset,T=H(o);if(!T.height||te(f))return;let _=!1;const m=H(u);r==="up"?_=T.top-m.top<=p:_=m.bottom-T.bottom<=p,_&&(l.value=!0,c("update:loading",!0),c("load"))})},x=()=>{if(e.finished){const r=d.finished?d.finished():e.finishedText;if(r)return h("div",{class:D("finished-text")},[r])}},k=()=>{c("update:error",!1),s()},g=()=>{if(e.error){const r=d.error?d.error():e.errorText;if(r)return h("div",{role:"button",class:D("error-text"),tabindex:0,onClick:k},[r])}},w=()=>{if(l.value&&!e.finished&&!e.disabled)return h("div",{class:D("loading")},[d.loading?d.loading():e.loadingText!=null&&h(U,{class:D("loading-icon")},{default:()=>[e.loadingText||me("loading")]})])};return I(()=>[e.loading,e.finished,e.error],s),n&&I(n,r=>{r&&s()}),Z(()=>{l.value=e.loading}),F(()=>{e.immediateCheck&&s()}),ee({check:s}),K("scroll",s,{target:o,passive:!0}),()=>{var r;const p=(r=d.default)==null?void 0:r.call(d),T=h("div",{ref:u,class:D("placeholder")},null);return h("div",{ref:f,role:"feed",class:D(),"aria-busy":l.value},[e.direction==="down"?p:T,w(),x(),g(),e.direction==="up"?p:T])}}});const ve=Y(ge),[xe,E,Te]=M("pull-refresh"),O=50,ye=["pulling","loosing","success"],be={disabled:Boolean,modelValue:Boolean,headHeight:C(O),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ae,successDuration:C(500),animationDuration:C(300)};var pe=R({name:xe,props:be,emits:["change","refresh","update:modelValue"],setup(e,{emit:c,slots:d}){let l;const f=y(),u=y(),n=A(f),a=le({status:"normal",distance:0,duration:0}),o=se(),s=()=>{if(e.headHeight!==O)return{height:`${e.headHeight}px`}},x=()=>a.status!=="loading"&&a.status!=="success"&&!e.disabled,k=t=>{const i=+(e.pullDistance||e.headHeight);return t>i&&(t<i*2?t=i+(t-i)/2:t=i*1.5+(t-i*2)/4),Math.round(t)},g=(t,i)=>{const b=+(e.pullDistance||e.headHeight);a.distance=t,i?a.status="loading":t===0?a.status="normal":t<b?a.status="pulling":a.status="loosing",c("change",{status:a.status,distance:t})},w=()=>{const{status:t}=a;return t==="normal"?"":e[`${t}Text`]||Te(t)},r=()=>{const{status:t,distance:i}=a;if(d[t])return d[t]({distance:i});const b=[];return ye.includes(t)&&b.push(h("div",{class:E("text")},[w()])),t==="loading"&&b.push(h(U,{class:E("loading")},{default:w})),b},p=()=>{a.status="success",setTimeout(()=>{g(0)},+e.successDuration)},T=t=>{l=ne(n.value)===0,l&&(a.duration=0,o.start(t))},_=t=>{x()&&T(t)},m=t=>{if(x()){l||T(t);const{deltaY:i}=o;o.move(t),l&&i.value>=0&&o.isVertical()&&(oe(t),g(k(i.value)))}},v=()=>{l&&o.deltaY.value&&x()&&(a.duration=+e.animationDuration,a.status==="loosing"?(g(+e.headHeight,!0),c("update:modelValue",!0),N(()=>c("refresh"))):g(0))};return I(()=>e.modelValue,t=>{a.duration=+e.animationDuration,t?g(+e.headHeight,!0):d.success||e.successText?p():g(0,!1)}),K("touchmove",m,{target:u}),()=>{var t;const i={transitionDuration:`${a.duration}ms`,transform:a.distance?`translate3d(0,${a.distance}px, 0)`:""};return h("div",{ref:f,class:E()},[h("div",{ref:u,class:E("track"),style:i,onTouchstartPassive:_,onTouchend:v,onTouchcancel:v},[h("div",{class:E("head"),style:s()},[r()]),(t=d.default)==null?void 0:t.call(d)])])}}});const _e=Y(pe),Se=R({name:"PullRefreshList",__name:"PullRefreshList",props:{loadData:{},pageSize:{default:10},immediate:{type:Boolean,default:!0},pullText:{default:"下拉即可刷新..."},releaseText:{default:"释放即可刷新..."},loadingText:{default:"刷新中..."},successText:{default:"刷新成功"},finishedText:{default:"没有更多了"},emptyText:{default:"暂无数据"},emptyImage:{default:void 0},disabled:{type:Boolean,default:!1},disabledLoad:{type:Boolean,default:!1},itemKey:{type:[String,Function],default:"id"}},emits:["loadComplete","refreshComplete","loadMoreComplete"],setup(e,{expose:c,emit:d}){const l=e,f=d,u=y(),n=y(!1),a=y(!1),o=y(!1),s=y([]),x=y(1),k=(m,v)=>typeof l.itemKey=="function"?l.itemKey(m):m[l.itemKey]??v,g=async(m=!1)=>{try{m&&(x.value=1,o.value=!1);const v=await l.loadData(x.value,l.pageSize),{list:t,hasMore:i}=v;if(m)s.value=t,f("refreshComplete",t);else{const b=s.value;b.push(...t),s.value=b,f("loadMoreComplete",t)}o.value=!i,f("loadComplete",s.value),i&&(x.value+=1)}catch(v){console.error("加载数据失败:",v),o.value=!0}finally{a.value=!1,n.value=!1}},w=async()=>{if(l.disabled){n.value=!1;return}n.value=!0,await g(!0)},r=async()=>{if(l.disabledLoad||o.value){a.value=!1;return}a.value=!0,await g(!1)},p=async()=>{n.value=!0,await g(!0)},T=()=>{x.value=1,s.value=[],o.value=!1,a.value=!1,n.value=!1},_=()=>{!o.value&&!a.value&&s.value.length===0&&(a.value=!0,g(!1))};return I(()=>l.immediate,m=>{m&&_()},{immediate:!0}),F(()=>{l.immediate&&_()}),c({refresh:p,reset:T,list:s,page:x,finished:o,loading:a,refreshing:n}),(m,v)=>{const t=re,i=X,b=ve,W=_e;return L(),$(W,{modelValue:n.value,"onUpdate:modelValue":v[1]||(v[1]=S=>n.value=S),disabled:e.disabled,"pull-text":e.pullText,"release-text":e.releaseText,"loading-text":e.loadingText,"success-text":e.successText,onRefresh:w},{default:P(()=>[h(b,{ref_key:"listRef",ref:u,loading:a.value,"onUpdate:loading":v[0]||(v[0]=S=>a.value=S),finished:o.value,"finished-text":e.finishedText,disabled:e.disabledLoad,onLoad:r},{default:P(()=>[V(m.$slots,"default",{list:s.value,loading:a.value,finished:o.value},()=>[s.value.length===0&&!a.value&&!n.value?(L(),$(t,{key:0,description:e.emptyText,image:e.emptyImage},null,8,["description","image"])):(L(!0),j(ie,{key:1},de(s.value,(S,B)=>(L(),$(i,{key:k(S,B)},{default:P(()=>[V(m.$slots,"item",{item:S,index:B},()=>[z("div",null,ue(S),1)],!0)]),_:2},1024))),128))],!0)]),_:3},8,["loading","finished","finished-text","disabled"])]),_:3},8,["modelValue","disabled","pull-text","release-text","loading-text","success-text"])}}}),we=G(Se,[["__scopeId","data-v-e92a262d"]]),De={class:"test-container"},ke={class:"content-wrapper"},Ee=R({name:"TestPage",__name:"ListExample",setup(e){const c=async(d,l)=>{await new Promise(s=>setTimeout(s,1e3));const f=50,u=(d-1)*l,n=Math.min(u+l,f),a=[];for(let s=u;s<n;s++)a.push({id:s+1,title:`列表项 ${s+1}`,desc:`这是第 ${s+1} 条数据的描述信息`,time:new Date(Date.now()-s*6e4).toLocaleString()});const o=n<f;return{list:a,hasMore:o}};return(d,l)=>{const f=X;return L(),j("div",De,[z("div",ke,[h(we,{"load-data":c,"page-size":10,"empty-text":"暂无数据","finished-text":"没有更多了",onLoadComplete:l[0]||(l[0]=u=>console.log("加载完成，共",u.length,"条数据")),onRefreshComplete:l[1]||(l[1]=u=>console.log("刷新完成，共",u.length,"条数据"))},{item:P(({item:u,index:n})=>[h(f,{title:u.title,label:u.desc,value:u.time,"is-link":"",onClick:a=>console.log("点击了第",n+1,"项")},null,8,["title","label","value","onClick"])]),_:1})])])}}}),He=G(Ee,[["__scopeId","data-v-904a6e41"]]);export{He as default};
