import{d as x,r as c,o as I,p as V,a as p,Z as _,x as w,X as o,C as g,s as B,A as E}from"./index-BpSWxPrb.js";import{U as N}from"./index-Cma0HrPp.js";import{_ as h}from"./_plugin-vue_export-helper-Ckl9UNWA.js";import{B as j}from"./index-DlLRnzvA.js";import"./index-Cj1ANp8p.js";import"./use-route-Bucj-b2E.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"f7e57e3c537ca0bc1e582f9ec803810f33e7d1e0"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="91146bb5-20f7-45a8-8595-f63ffc6e478f",t._sentryDebugIdIdentifier="sentry-dbid-91146bb5-20f7-45a8-8595-f63ffc6e478f")})()}catch{}const A={class:"base-upload"},R=x({__name:"BaseUpload",props:{modelValue:{type:[String,Array],default:""},maxCount:{type:Number,default:1},maxSize:{type:Number,default:5},accept:{type:String,default:"image/*"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},beforeRead:{type:Function,default:void 0},upload:{type:Function,required:!0}},emits:["update:modelValue","change"],setup(t,{expose:n,emit:r}){const l=t,m=r,u=c([]),e=c();I(()=>l.modelValue,()=>{if(!l.modelValue){u.value=[];return}const d=Array.isArray(l.modelValue)?l.modelValue:[l.modelValue],s=u.value.filter(a=>a.status==="done"&&a.url).map(a=>a.url);JSON.stringify(d)!==JSON.stringify(s)&&(u.value=d.map(a=>({url:a,status:"done",message:"上传成功",isImage:!0})))},{immediate:!0});const i=async d=>{const s=Array.isArray(d)?d:[d];for(const a of s)if(a.file){a.status="uploading",a.message="上传中...";try{if(l.upload){const f=await l.upload(a.file);a.status="done",a.message="上传成功",a.url=f}else throw new Error("未提供 upload 方法")}catch(f){a.status="failed",a.message="上传失败",console.error("Upload failed:",f)}}b()},U=()=>{b()},b=()=>{const d=u.value.filter(a=>a.status==="done"&&a.url).map(a=>a.url);let s;l.maxCount===1?s=d[0]??"":s=d,m("update:modelValue",s),m("change",s)},S=()=>{_(`文件大小不能超过 ${l.maxSize}MB`)};return n({fileList:u,uploaderRef:e}),(d,s)=>{const a=N;return w(),V("div",A,[p(a,{ref_key:"uploaderRef",ref:e,modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=f=>u.value=f),"max-count":t.maxCount,"max-size":t.maxSize*1024*1024,accept:t.accept,disabled:t.disabled,readonly:t.readonly,deletable:!t.readonly,"preview-full-image":!0,"before-read":t.beforeRead,"after-read":i,onDelete:U,onOversize:S},null,8,["modelValue","max-count","max-size","accept","disabled","readonly","deletable","before-read"])])}}}),v=h(R,[["__scopeId","data-v-60c68bb9"]]),T={class:"upload-example-page"},k={class:"content"},C={class:"demo-card"},z={class:"upload-box"},D={class:"value-preview"},L={class:"demo-card"},F={class:"upload-box"},O={class:"value-preview"},$={class:"demo-card"},J={class:"upload-box"},M={class:"actions"},P=x({name:"UploadExample",__name:"UploadExample",setup(t){const n=c("https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"),r=c(["https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg","https://fastly.jsdelivr.net/npm/@vant/assets/tree.jpeg"]),l=u=>new Promise(e=>{setTimeout(()=>{e(`https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg?hash=${Math.random()}`)},1e3)}),m=()=>{console.log("Avatar URL:",n.value),console.log("Product Images:",r.value),_("提交成功，请查看控制台数据")};return(u,e)=>{const y=j;return w(),V("div",T,[o("div",k,[o("section",C,[e[3]||(e[3]=o("h3",null,"1. 单图上传 (头像)",-1)),e[4]||(e[4]=o("p",{class:"desc"},"v-model 绑定值为字符串，限制数量 1",-1)),o("div",z,[p(v,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=i=>n.value=i),"max-count":1,upload:l},null,8,["modelValue"])]),o("div",D,"当前值: "+g(n.value||"空"),1)]),o("section",L,[e[5]||(e[5]=o("h3",null,"2. 多图上传 (商品图)",-1)),e[6]||(e[6]=o("p",{class:"desc"},"v-model 绑定值为数组，限制数量 5",-1)),o("div",F,[p(v,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=i=>r.value=i),"max-count":5,upload:l},null,8,["modelValue"])]),o("div",O," 当前值: "+g(JSON.stringify(r.value,null,2)),1)]),o("section",$,[e[7]||(e[7]=o("h3",null,"3. 只读模式",-1)),o("div",J,[p(v,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=i=>r.value=i),readonly:"",upload:l},null,8,["modelValue"])])]),o("div",M,[p(y,{type:"primary",block:"",round:"",onClick:m},{default:B(()=>[...e[8]||(e[8]=[E(" 获取当前数据 ",-1)])]),_:1})])])])}}}),K=h(P,[["__scopeId","data-v-df243925"]]);export{K as default};
