import{d as y,r as Z,o as w,a2 as O,aU as S,p as T,x as z,E as D,a as r,X as h,s as d,z as B}from"./index-Dl01RQ6O.js";import{C as E}from"./index-mptTmHL0.js";import{S as x}from"./index-SHtNDCB7.js";import{C as I}from"./index-BOjqb5K1.js";import{S as U}from"./index-DOfKwWT7.js";import{N as P}from"./index-D7__azfu.js";import{_ as L}from"./_plugin-vue_export-helper-CbkZt4eH.js";import"./use-route-DZOD05gS.js";import"./use-placeholder-CmJwYh1_.js";import"./use-height-fYRUoBwt.js";(function(){try{var m=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};m.SENTRY_RELEASE={id:"dadf989baaa19ca9a7dda97cefda507d3b8f8f5a"}}catch{}})();try{(function(){var m=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new m.Error().stack;o&&(m._sentryDebugIds=m._sentryDebugIds||{},m._sentryDebugIds[o]="1833ce65-d12e-4cd5-ae4f-ca75fe0bf908",m._sentryDebugIdIdentifier="sentry-dbid-1833ce65-d12e-4cd5-ae4f-ca75fe0bf908")})()}catch{}const _="tianditu-api",R="dbbcf35162406f7e2beb641dc342a88d",N=y({name:"BaseMap",__name:"BaseMap",props:{zoom:{default:12},center:{},showZoomControl:{type:Boolean,default:!0},zoomControlPosition:{default:"bottomright"},showScaleControl:{type:Boolean,default:!0},showMapTypeControl:{type:Boolean,default:!1},showOverviewMapControl:{type:Boolean,default:!1},enableScrollWheelZoom:{type:Boolean,default:!0},enableDoubleClickZoom:{type:Boolean,default:!0},enableDragging:{type:Boolean,default:!0},enableKeyboard:{type:Boolean,default:!1},markers:{default:()=>[]},autoLocate:{type:Boolean,default:!1}},setup(m){const o=m,f={lng:116.397128,lat:39.904211},n=Z(null);let t=null;const e={zoom:null,scale:null,mapType:null,overview:null},g=l=>{const a=window;switch(l){case"topright":return a.T_ANCHOR_TOP_RIGHT;case"bottomleft":return a.T_ANCHOR_BOTTOM_LEFT;case"bottomright":return a.T_ANCHOR_BOTTOM_RIGHT;case"topleft":default:return a.T_ANCHOR_TOP_LEFT}},b=()=>{if(!t)return;const l=window.T;l&&(o.showZoomControl?e.zoom||(e.zoom=new l.Control.Zoom({position:g(o.zoomControlPosition)}),t.addControl(e.zoom)):e.zoom&&(t.removeControl(e.zoom),e.zoom=null),o.showScaleControl?e.scale||(e.scale=new l.Control.Scale,t.addControl(e.scale)):e.scale&&(t.removeControl(e.scale),e.scale=null),o.showMapTypeControl?e.mapType||(e.mapType=new l.Control.MapType,t.addControl(e.mapType)):e.mapType&&(t.removeControl(e.mapType),e.mapType=null),o.showOverviewMapControl?e.overview||(e.overview=new l.Control.OverviewMap({isOpen:!0}),t.addControl(e.overview)):e.overview&&(t.removeControl(e.overview),e.overview=null))},c=()=>{t&&(o.enableScrollWheelZoom?t.enableScrollWheelZoom():t.disableScrollWheelZoom(),o.enableDoubleClickZoom?t.enableDoubleClickZoom():t.disableDoubleClickZoom(),o.enableDragging?t.enableDrag():t.disableDrag(),o.enableKeyboard?t.enableKeyboard():t.disableKeyboard())},s=()=>{if(!t)return;const l=window.T;if(l&&(t.clearOverLays(),o.markers&&o.markers.length>0&&o.markers.forEach(a=>{const p=new l.Marker(new l.LngLat(a.lng,a.lat));if(a.title){const C=new l.Label({text:a.title,position:new l.LngLat(a.lng,a.lat),offset:new l.Point(0,-20)});t.addOverLay(C)}t.addOverLay(p)}),o.center)){const a=new l.Marker(new l.LngLat(o.center.lng,o.center.lat));t.addOverLay(a)}},u=()=>{if(!t)return;const l=window.T;navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>{const{longitude:p,latitude:C}=a.coords,v=new l.LngLat(p,C);t.panTo(v);const M=new l.Marker(v),V=new l.Label({text:"当前位置",position:v,offset:new l.Point(0,-20)});t.addOverLay(M),t.addOverLay(V)},a=>{console.warn("浏览器定位失败:",a)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):console.warn("当前浏览器不支持地理定位服务。")},i=()=>{const l=window.T;if(!(!l||!n.value)){if(n.value.clientHeight===0){setTimeout(i,100);return}if(!t)try{t=new l.Map(n.value);const a=o.center||f;t.centerAndZoom(new l.LngLat(a.lng,a.lat),o.zoom),b(),c(),s(),o.autoLocate&&u()}catch(a){console.error("天地图初始化异常:",a)}}},k=()=>{if(window.T){i();return}let l=document.getElementById(_);l?l.addEventListener("load",i):(l=document.createElement("script"),l.id=_,l.src=`https://api.tianditu.gov.cn/api?v=4.0&tk=${R}`,l.onload=i,document.head.appendChild(l))};return w(()=>[o.showZoomControl,o.showScaleControl,o.showMapTypeControl,o.showOverviewMapControl,o.zoomControlPosition],()=>{b()}),w(()=>o.autoLocate,l=>{if(l)u();else{s();const a=window.T;if(t&&a){const p=o.center||f;t.panTo(new a.LngLat(p.lng,p.lat))}}}),w(()=>[o.center,o.zoom],()=>{if(t){const l=window.T,a=o.center||f;t.panTo(new l.LngLat(a.lng,a.lat)),o.zoom&&t.getZoom()!==o.zoom&&t.setZoom(o.zoom)}s()},{deep:!0}),w(()=>[o.enableScrollWheelZoom,o.enableDoubleClickZoom,o.enableDragging,o.enableKeyboard],()=>{c()}),w(()=>o.markers,()=>{s()},{deep:!0}),O(()=>{k()}),S(()=>{t=null}),(l,a)=>(z(),T("div",{ref_key:"mapContainer",ref:n,class:"map-container"},null,512))}}),A=L(N,[["__scopeId","data-v-c31b7478"]]),W={class:"map-example-page"},H={class:"content-area"},K={class:"map-wrapper"},F={class:"controls-wrapper"},G=y({__name:"MapExample",setup(m){const o=B(),f=()=>{o.back()},n=D({zoom:12,showZoomControl:!0,zoomControlPosition:"bottomright",showScaleControl:!0,showMapTypeControl:!1,showOverviewMapControl:!1,enableScrollWheelZoom:!0,enableDragging:!0,enableDoubleClickZoom:!0,enableKeyboard:!1,autoLocate:!0});return(t,e)=>{const g=P,b=U,c=I,s=x,u=E;return z(),T("div",W,[r(g,{title:"天地图组件示例","left-text":"返回","left-arrow":"",onClickLeft:f}),h("div",H,[h("div",K,[r(A,{zoom:n.zoom,"show-zoom-control":n.showZoomControl,"zoom-control-position":n.zoomControlPosition,"show-scale-control":n.showScaleControl,"show-map-type-control":n.showMapTypeControl,"show-overview-map-control":n.showOverviewMapControl,"enable-scroll-wheel-zoom":n.enableScrollWheelZoom,"enable-dragging":n.enableDragging,"enable-double-click-zoom":n.enableDoubleClickZoom,"enable-keyboard":n.enableKeyboard,"auto-locate":n.autoLocate},null,8,["zoom","show-zoom-control","zoom-control-position","show-scale-control","show-map-type-control","show-overview-map-control","enable-scroll-wheel-zoom","enable-dragging","enable-double-click-zoom","enable-keyboard","auto-locate"])]),h("div",F,[r(u,{title:"状态控制"},{default:d(()=>[r(c,{title:"缩放级别",center:""},{"right-icon":d(()=>[r(b,{modelValue:n.zoom,"onUpdate:modelValue":e[0]||(e[0]=i=>n.zoom=i),min:"1",max:"18"},null,8,["modelValue"])]),_:1}),r(c,{title:"自动定位",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.autoLocate,"onUpdate:modelValue":e[1]||(e[1]=i=>n.autoLocate=i),size:"20"},null,8,["modelValue"])]),_:1})]),_:1}),r(u,{title:"控件开关"},{default:d(()=>[r(c,{title:"缩放控件",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.showZoomControl,"onUpdate:modelValue":e[2]||(e[2]=i=>n.showZoomControl=i),size:"20"},null,8,["modelValue"])]),_:1}),r(c,{title:"比例尺控件",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.showScaleControl,"onUpdate:modelValue":e[3]||(e[3]=i=>n.showScaleControl=i),size:"20"},null,8,["modelValue"])]),_:1}),r(c,{title:"地图类型控件",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.showMapTypeControl,"onUpdate:modelValue":e[4]||(e[4]=i=>n.showMapTypeControl=i),size:"20"},null,8,["modelValue"])]),_:1}),r(c,{title:"鹰眼控件",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.showOverviewMapControl,"onUpdate:modelValue":e[5]||(e[5]=i=>n.showOverviewMapControl=i),size:"20"},null,8,["modelValue"])]),_:1})]),_:1}),r(u,{title:"交互设置"},{default:d(()=>[r(c,{title:"滚轮缩放",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.enableScrollWheelZoom,"onUpdate:modelValue":e[6]||(e[6]=i=>n.enableScrollWheelZoom=i),size:"20"},null,8,["modelValue"])]),_:1}),r(c,{title:"拖拽地图",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.enableDragging,"onUpdate:modelValue":e[7]||(e[7]=i=>n.enableDragging=i),size:"20"},null,8,["modelValue"])]),_:1}),r(c,{title:"双击缩放",center:""},{"right-icon":d(()=>[r(s,{modelValue:n.enableDoubleClickZoom,"onUpdate:modelValue":e[8]||(e[8]=i=>n.enableDoubleClickZoom=i),size:"20"},null,8,["modelValue"])]),_:1})]),_:1})])])])}}}),le=L(G,[["__scopeId","data-v-9b126e3e"]]);export{le as default};
