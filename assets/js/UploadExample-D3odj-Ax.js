import{d as V,r as c,B as S,a as _,b as p,s as w,o as U,i as o,t as x,w as I,j as N}from"./index-D3iEbD-x.js";import{N as E}from"./index-BXggL-Qo.js";import{U as j}from"./index-CGu9fJju.js";import{_ as h}from"./_plugin-vue_export-helper-CaF5yFZK.js";import{B as k}from"./index-L5KECWFd.js";import"./index-BL7LAXdw.js";import"./use-route-BYBmQqsa.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"0b41023e4cb7a08a546cdc5389cade6da56f1f8a"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="1177512f-147d-49c1-aaf5-09d5eaa588e0",t._sentryDebugIdIdentifier="sentry-dbid-1177512f-147d-49c1-aaf5-09d5eaa588e0")})()}catch{}const R={class:"base-upload"},T=V({__name:"BaseUpload",props:{modelValue:{type:[String,Array],default:""},maxCount:{type:Number,default:1},maxSize:{type:Number,default:5},accept:{type:String,default:"image/*"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},beforeRead:{type:Function,default:void 0},upload:{type:Function,required:!0}},emits:["update:modelValue","change"],setup(t,{expose:n,emit:u}){const l=t,m=u,d=c([]),e=c();S(()=>l.modelValue,()=>{if(!l.modelValue){d.value=[];return}const r=Array.isArray(l.modelValue)?l.modelValue:[l.modelValue],s=d.value.filter(a=>a.status==="done"&&a.url).map(a=>a.url);JSON.stringify(r)!==JSON.stringify(s)&&(d.value=r.map(a=>({url:a,status:"done",message:"上传成功",isImage:!0})))},{immediate:!0});const v=async r=>{const s=Array.isArray(r)?r:[r];for(const a of s)if(a.file){a.status="uploading",a.message="上传中...";try{if(l.upload){const f=await l.upload(a.file);a.status="done",a.message="上传成功",a.url=f}else throw new Error("未提供 upload 方法")}catch(f){a.status="failed",a.message="上传失败",console.error("Upload failed:",f)}}g()},i=()=>{g()},g=()=>{const r=d.value.filter(a=>a.status==="done"&&a.url).map(a=>a.url);let s;l.maxCount===1?s=r[0]??"":s=r,m("update:modelValue",s),m("change",s)},B=()=>{w(`文件大小不能超过 ${l.maxSize}MB`)};return n({fileList:d,uploaderRef:e}),(r,s)=>{const a=j;return U(),_("div",R,[p(a,{ref_key:"uploaderRef",ref:e,modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=f=>d.value=f),"max-count":t.maxCount,"max-size":t.maxSize*1024*1024,accept:t.accept,disabled:t.disabled,readonly:t.readonly,deletable:!t.readonly,"preview-full-image":!0,"before-read":t.beforeRead,"after-read":v,onDelete:i,onOversize:B},null,8,["modelValue","max-count","max-size","accept","disabled","readonly","deletable","before-read"])])}}}),y=h(T,[["__scopeId","data-v-60c68bb9"]]),A={class:"upload-example-page"},C={class:"content"},z={class:"demo-card"},D={class:"upload-box"},L={class:"value-preview"},$={class:"demo-card"},F={class:"upload-box"},O={class:"value-preview"},J={class:"demo-card"},M={class:"upload-box"},P={class:"actions"},q=V({name:"UploadExample",__name:"UploadExample",setup(t){const n=c("https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"),u=c(["https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg","https://fastly.jsdelivr.net/npm/@vant/assets/tree.jpeg"]),l=d=>new Promise(e=>{setTimeout(()=>{e(`https://fastly.jsdelivr.net/npm/@vant/assets/leaf.jpeg?hash=${Math.random()}`)},1e3)}),m=()=>{console.log("Avatar URL:",n.value),console.log("Product Images:",u.value),w("提交成功，请查看控制台数据")};return(d,e)=>{const b=E,v=k;return U(),_("div",A,[p(b,{title:"BaseUpload 示例","left-text":"返回","left-arrow":"",onClickLeft:e[0]||(e[0]=i=>d.$router.back())}),o("div",C,[o("section",z,[e[4]||(e[4]=o("h3",null,"1. 单图上传 (头像)",-1)),e[5]||(e[5]=o("p",{class:"desc"},"v-model 绑定值为字符串，限制数量 1",-1)),o("div",D,[p(y,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=i=>n.value=i),"max-count":1,upload:l},null,8,["modelValue"])]),o("div",L,"当前值: "+x(n.value||"空"),1)]),o("section",$,[e[6]||(e[6]=o("h3",null,"2. 多图上传 (商品图)",-1)),e[7]||(e[7]=o("p",{class:"desc"},"v-model 绑定值为数组，限制数量 5",-1)),o("div",F,[p(y,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=i=>u.value=i),"max-count":5,upload:l},null,8,["modelValue"])]),o("div",O," 当前值: "+x(JSON.stringify(u.value,null,2)),1)]),o("section",J,[e[8]||(e[8]=o("h3",null,"3. 只读模式",-1)),o("div",M,[p(y,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=i=>u.value=i),readonly:"",upload:l},null,8,["modelValue"])])]),o("div",P,[p(v,{type:"primary",block:"",round:"",onClick:m},{default:I(()=>[...e[9]||(e[9]=[N(" 获取当前数据 ",-1)])]),_:1})])])])}}}),Z=h(q,[["__scopeId","data-v-f6f78644"]]);export{Z as default};
