import{d as R,m as X,n as Q,p as C,q as M,r as y,v as N,x as W,y as I,z as Z,o as A,A as ee,B as K,a as g,C as F,D as H,E as te,L as U,F as z,G as ae,H as le,I as se,J as ne,K as oe,M as B,w as P,f as E,N as V,c as Y,O as ie,P as re,b as G,t as ue,u as de,e as ce}from"./index-CPhkr4Pe.js";import{C as O}from"./index-0BjzaYNX.js";import{N as fe}from"./index-B8diGhUx.js";import{E as me}from"./index-DZyQnV1h.js";import{u as ge}from"./use-tab-status-S6M36NoX.js";import{_ as j}from"./_plugin-vue_export-helper-BM5uEb7X.js";import"./use-route-CM-qhGoy.js";import"./use-placeholder-2GXY53DY.js";import"./use-id-B0TxtryC.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"3a9292ca7a3904f73afa4ca8b96ef6af9893536b"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},f=new e.Error().stack;f&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[f]="3a4ce4cb-8f36-4015-8216-d15fe024e35e",e._sentryDebugIdIdentifier="sentry-dbid-3a4ce4cb-8f36-4015-8216-d15fe024e35e")})()}catch{}const[he,k,ve]=M("list"),xe={error:Boolean,offset:C(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:Q("down"),loadingText:{type:String,default:""},finishedText:String,immediateCheck:X};var Te=R({name:he,props:xe,emits:["load","update:error","update:loading"],setup(e,{emit:f,slots:d}){const l=y(e.loading),i=y(),x=y(),o=ge(),t=N(i),s=W(()=>e.scroller||t.value),n=()=>{F(()=>{if(l.value||e.finished||e.disabled||e.error||o?.value===!1)return;const{direction:c}=e,p=+e.offset,T=H(s);if(!T.height||te(i))return;let _=!1;const m=H(x);c==="up"?_=T.top-m.top<=p:_=m.bottom-T.bottom<=p,_&&(l.value=!0,f("update:loading",!0),f("load"))})},r=()=>{if(e.finished){const c=d.finished?d.finished():e.finishedText;if(c)return g("div",{class:k("finished-text")},[c])}},D=()=>{f("update:error",!1),n()},h=()=>{if(e.error){const c=d.error?d.error():e.errorText;if(c)return g("div",{role:"button",class:k("error-text"),tabindex:0,onClick:D},[c])}},w=()=>{if(l.value&&!e.finished&&!e.disabled)return g("div",{class:k("loading")},[d.loading?d.loading():e.loadingText!=null&&g(U,{class:k("loading-icon")},{default:()=>[e.loadingText||ve("loading")]})])};return I(()=>[e.loading,e.finished,e.error],n),o&&I(o,c=>{c&&n()}),Z(()=>{l.value=e.loading}),A(()=>{e.immediateCheck&&n()}),ee({check:n}),K("scroll",n,{target:s,passive:!0}),()=>{var c;const p=(c=d.default)==null?void 0:c.call(d),T=g("div",{ref:x,class:k("placeholder")},null);return g("div",{ref:i,role:"feed",class:k(),"aria-busy":l.value},[e.direction==="down"?p:T,w(),r(),h(),e.direction==="up"?p:T])}}});const ye=z(Te),[be,L,pe]=M("pull-refresh"),q=50,_e=["pulling","loosing","success"],Se={disabled:Boolean,modelValue:Boolean,headHeight:C(q),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:ae,successDuration:C(500),animationDuration:C(300)};var we=R({name:be,props:Se,emits:["change","refresh","update:modelValue"],setup(e,{emit:f,slots:d}){let l;const i=y(),x=y(),o=N(i),t=le({status:"normal",distance:0,duration:0}),s=se(),n=()=>{if(e.headHeight!==q)return{height:`${e.headHeight}px`}},r=()=>t.status!=="loading"&&t.status!=="success"&&!e.disabled,D=a=>{const u=+(e.pullDistance||e.headHeight);return a>u&&(a<u*2?a=u+(a-u)/2:a=u*1.5+(a-u*2)/4),Math.round(a)},h=(a,u)=>{const b=+(e.pullDistance||e.headHeight);t.distance=a,u?t.status="loading":a===0?t.status="normal":a<b?t.status="pulling":t.status="loosing",f("change",{status:t.status,distance:a})},w=()=>{const{status:a}=t;return a==="normal"?"":e[`${a}Text`]||pe(a)},c=()=>{const{status:a,distance:u}=t;if(d[a])return d[a]({distance:u});const b=[];return _e.includes(a)&&b.push(g("div",{class:L("text")},[w()])),a==="loading"&&b.push(g(U,{class:L("loading")},{default:w})),b},p=()=>{t.status="success",setTimeout(()=>{h(0)},+e.successDuration)},T=a=>{l=ne(o.value)===0,l&&(t.duration=0,s.start(a))},_=a=>{r()&&T(a)},m=a=>{if(r()){l||T(a);const{deltaY:u}=s;s.move(a),l&&u.value>=0&&s.isVertical()&&(oe(a),h(D(u.value)))}},v=()=>{l&&s.deltaY.value&&r()&&(t.duration=+e.animationDuration,t.status==="loosing"?(h(+e.headHeight,!0),f("update:modelValue",!0),F(()=>f("refresh"))):h(0))};return I(()=>e.modelValue,a=>{t.duration=+e.animationDuration,a?h(+e.headHeight,!0):d.success||e.successText?p():h(0,!1)}),K("touchmove",m,{target:x}),()=>{var a;const u={transitionDuration:`${t.duration}ms`,transform:t.distance?`translate3d(0,${t.distance}px, 0)`:""};return g("div",{ref:i,class:L()},[g("div",{ref:x,class:L("track"),style:u,onTouchstartPassive:_,onTouchend:v,onTouchcancel:v},[g("div",{class:L("head"),style:n()},[c()]),(a=d.default)==null?void 0:a.call(d)])])}}});const ke=z(we),De=R({name:"PullRefreshList",__name:"PullRefreshList",props:{loadData:{},pageSize:{default:10},immediate:{type:Boolean,default:!0},pullText:{default:"下拉即可刷新..."},releaseText:{default:"释放即可刷新..."},loadingText:{default:"刷新中..."},successText:{default:"刷新成功"},finishedText:{default:"没有更多了"},emptyText:{default:"暂无数据"},emptyImage:{default:void 0},disabled:{type:Boolean,default:!1},disabledLoad:{type:Boolean,default:!1},itemKey:{type:[String,Function],default:"id"}},emits:["loadComplete","refreshComplete","loadMoreComplete"],setup(e,{expose:f,emit:d}){const l=e,i=d,x=y(),o=y(!1),t=y(!1),s=y(!1),n=y([]),r=y(1),D=(m,v)=>typeof l.itemKey=="function"?l.itemKey(m):m[l.itemKey]??v,h=async(m=!1)=>{try{m&&(r.value=1,s.value=!1);const v=await l.loadData(r.value,l.pageSize),{list:a,hasMore:u}=v;if(m)n.value=a,i("refreshComplete",a);else{const b=n.value;b.push(...a),n.value=b,i("loadMoreComplete",a)}s.value=!u,i("loadComplete",n.value),u&&(r.value+=1)}catch(v){console.error("加载数据失败:",v),s.value=!0}finally{t.value=!1,o.value=!1}},w=async()=>{if(l.disabled){o.value=!1;return}o.value=!0,await h(!0)},c=async()=>{if(l.disabledLoad||s.value){t.value=!1;return}t.value=!0,await h(!1)},p=async()=>{o.value=!0,await h(!0)},T=()=>{r.value=1,n.value=[],s.value=!1,t.value=!1,o.value=!1},_=()=>{!s.value&&!t.value&&n.value.length===0&&(t.value=!0,h(!1))};return I(()=>l.immediate,m=>{m&&_()},{immediate:!0}),A(()=>{l.immediate&&_()}),f({refresh:p,reset:T,list:n,page:r,finished:s,loading:t,refreshing:o}),(m,v)=>{const a=me,u=O,b=ye,J=ke;return E(),B(J,{modelValue:o.value,"onUpdate:modelValue":v[1]||(v[1]=S=>o.value=S),disabled:e.disabled,"pull-text":e.pullText,"release-text":e.releaseText,"loading-text":e.loadingText,"success-text":e.successText,onRefresh:w},{default:P(()=>[g(b,{ref_key:"listRef",ref:x,loading:t.value,"onUpdate:loading":v[0]||(v[0]=S=>t.value=S),finished:s.value,"finished-text":e.finishedText,disabled:e.disabledLoad,onLoad:c},{default:P(()=>[V(m.$slots,"default",{list:n.value,loading:t.value,finished:s.value},()=>[n.value.length===0&&!t.value&&!o.value?(E(),B(a,{key:0,description:e.emptyText,image:e.emptyImage},null,8,["description","image"])):(E(!0),Y(ie,{key:1},re(n.value,(S,$)=>(E(),B(u,{key:D(S,$)},{default:P(()=>[V(m.$slots,"item",{item:S,index:$},()=>[G("div",null,ue(S),1)],!0)]),_:2},1024))),128))],!0)]),_:3},8,["loading","finished","finished-text","disabled"])]),_:3},8,["modelValue","disabled","pull-text","release-text","loading-text","success-text"])}}}),Le=j(De,[["__scopeId","data-v-e92a262d"]]),Ee={class:"test-container"},Ce={class:"content-wrapper"},Pe=R({name:"TestPage",__name:"ListExample",setup(e){const f=ce(),d=async(l,i)=>{await new Promise(r=>setTimeout(r,1e3));const x=50,o=(l-1)*i,t=Math.min(o+i,x),s=[];for(let r=o;r<t;r++)s.push({id:r+1,title:`列表项 ${r+1}`,desc:`这是第 ${r+1} 条数据的描述信息`,time:new Date(Date.now()-r*6e4).toLocaleString()});const n=t<x;return{list:s,hasMore:n}};return(l,i)=>{const x=fe,o=O;return E(),Y("div",Ee,[g(x,{title:"下拉刷新与上拉加载","left-arrow":"",onClickLeft:i[0]||(i[0]=t=>de(f).back())}),G("div",Ce,[g(Le,{"load-data":d,"page-size":10,"empty-text":"暂无数据","finished-text":"没有更多了",onLoadComplete:i[1]||(i[1]=t=>console.log("加载完成，共",t.length,"条数据")),onRefreshComplete:i[2]||(i[2]=t=>console.log("刷新完成，共",t.length,"条数据"))},{item:P(({item:t,index:s})=>[g(o,{title:t.title,label:t.desc,value:t.time,"is-link":"",onClick:n=>console.log("点击了第",s+1,"项")},null,8,["title","label","value","onClick"])]),_:1})])])}}}),Ke=j(Pe,[["__scopeId","data-v-f590c0f3"]]);export{Ke as default};
